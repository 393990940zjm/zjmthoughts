(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76f26c98"],{1732:function(e,t,i){"use strict";var a=i("199f"),s=i.n(a);s.a},"199f":function(e,t,i){},"19ff":function(e,t,i){"use strict";var a=i("89258"),s=i.n(a);s.a},89258:function(e,t,i){},ad9b:function(e,t,i){"use strict";var a=i("cad9"),s=i.n(a);s.a},c3ff:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return 0===e.flag?i("div",[i("el-container",[i("el-header",[i("header-buttons",{attrs:{cssType:"1"},on:{buttonClickEvent:e.buttonClickEvent}})],1),i("el-main",{staticStyle:{"border-top":"1px solid #dedddd"}},[i("div",{staticClass:"area-main",staticStyle:{"border-top":"none"}},[i("VXETable",{ref:"xGrid",attrs:{height:e.$options.filters.getTableHeight(160),tableName:"role",tableLoading:e.tableLoading,tableDatas:e.tableDatas,tableColumns:e.tableColumns,tablePage:e.tablePage,highlightCurrentRow:!0},on:{onTablePageChange:e.onTablePageChange,chooseCheck:e.roleTableChooseCheck}})],1),i("el-dialog",{staticClass:"dialog-role",attrs:{title:e.titleName,visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeit}},[i("el-form",{ref:"roleForm",attrs:{model:e.form,rules:e.rolerules},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-row",[i("el-col",{attrs:{span:20,offset:1}},[i("el-form-item",{attrs:{label:"角色名称：","label-width":e.formLabelWidth,prop:"roleName"}},[i("el-input",{attrs:{autocomplete:"off",size:"small"},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1)],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"custom-button",attrs:{type:"primary"},on:{click:function(t){return e.confirm()}}},[e._v("保存")])],1)],1),i("el-dialog",{staticClass:"dialog-add-user",attrs:{title:"添加用户",visible:e.adddialogVisible,width:"50%"},on:{"update:visible":function(t){e.adddialogVisible=t},close:e.clearAddUserDialog}},[i("div",{staticClass:"main"},[i("div",{staticClass:"main-r"},[i("div",{staticClass:"scrollbar-container"},[i("el-scrollbar",{staticStyle:{height:"100%"}},[i("el-checkbox-group",{model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,(function(t,a){return i("el-checkbox",{key:a,attrs:{label:t.userId,value:t.userId}},[e._v(" "+e._s(t.realName?t.realName:t.userName)+" ")])})),1)],1)],1)])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"custom-button",on:{click:function(t){e.adddialogVisible=!1}}},[e._v("取消")]),i("el-button",{staticClass:"custom-button",attrs:{type:"primary"},on:{click:function(t){return e.addUserConfirm()}}},[e._v("保存")])],1)])],1)],1)],1):1===e.flag?i("div",[i("page-authority-setting",{attrs:{"role-id":e.roleid},on:{goBack:e.goBack,refreshParentMenu:e.refreshParentMenu}})],1):e._e()},s=[],l=(i("7db0"),i("caad"),i("a15b"),i("d81d"),i("a434"),i("b0c0"),i("b85c")),n=i("5530"),o=i("85a8"),r=i("5861"),c=i("cf46"),d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",[i("el-header",[i("HeaderTitle",{attrs:{titleName:e.titleName,flag:e.flag}})],1),i("el-main",{staticStyle:{"border-top":"1px solid #dedddd"}},[i("div",{staticClass:"main-cl"},[i("div",{staticClass:"main-l"},[i("div",{staticClass:"main-l-t"},[i("span",[e._v("模1块")])]),i("el-tree",{ref:"motree",staticStyle:{overflow:"auto"},attrs:{data:e.treeData,"node-key":"id","default-checked-keys":e.defkey,props:e.defaultProps,"default-expand-all":"","show-checkbox":""},on:{"check-change":e.currentChange}})],1)]),i("el-card",{staticStyle:{margin:"10px",height:"433px"}},[i("div",{staticClass:"main-r"},[i("ul",[i("li",[i("div",{staticClass:"main-r-l"},[i("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v(" 用户管理 ")])],1),i("div",{staticClass:"main-r-r"},[i("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,(function(t){return i("el-checkbox",{key:t,attrs:{label:t}},[e._v(e._s(t))])})),1)],1)]),i("li",[i("div",{staticClass:"main-r-l"},[i("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v(" 用户管理 ")])],1),i("div",{staticClass:"main-r-r"},[i("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,(function(t){return i("el-checkbox",{key:t,attrs:{label:t}},[e._v(e._s(t))])})),1)],1)])])])]),i("div",[i("el-button",{staticClass:"custom-button",attrs:{type:""},on:{click:e.goBack}},[e._v("返回")]),i("el-button",{staticClass:"custom-button",attrs:{type:"primary"},on:{click:e.comfirm}},[e._v("保存")])],1)],1)],1)},u=[],h=(i("a9e3"),i("96cf"),i("1da1")),f=["待添加"],m={props:{roleid:{type:Number}},data:function(){return{titleName:this.othertitlename,flag:!1,treeData:[],defaultProps:{children:"children",label:"menuName"},checkAll:!1,checkedCities:["待添加"],cities:f,isIndeterminate:!0,defkey:[]}},components:{HeaderTitle:o["a"]},methods:{goBack:function(e){this.$emit("goBack",0,e)},getTreeData:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},getbeaf:function(e,t){for(var i=0;i<e.length;i++)if(e[i].children)for(var a=0;a<e[i].children.length;a++)this.defkey.push(e[i].children[a].id);else void 0!==e[i].flag&&this.defkey.push(e[i].id)},handleCheckAllChange:function(e){this.checkedCities=e?f:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(e){var t=e.length;this.checkAll=t===this.cities.length,this.isIndeterminate=t>0&&t<this.cities.length},currentChange:function(e,t){},comfirm:function(){}},mounted:function(){this.getTreeData()}},g=m,b=g,p=(i("19ff"),i("2877")),v=Object(p["a"])(b,d,u,!1,null,"4f54a1e4",null),k=v.exports,C=i("eec9"),y=i("1d0c"),x=i("582a"),w=i("cc5e"),N=i("3fa5"),$=[{label:"等于",value:"eq"},{label:"不等于",value:"ne"},{label:"大于",value:"gt"},{label:"大于等于",value:"ge"},{label:"小于",value:"lt"},{label:"小于等于",value:"le"},{label:"包含",value:"like"},{label:"左包含",value:"leftlike"},{label:"右包含",value:"rightlike"},{label:"不包含",value:"notlike"}],S={name:"RoleManagement",data:function(){var e=this,t=this.$createElement;return{isSearchBoxShow:!1,typeOptions:$,treeData:[],checkAll:!1,checkedCities:[],cities:[],allUsers:[],uids:[],isIndeterminate:!0,defaultProps:{children:"children",label:"name"},tableLoading:!1,dialogVisible:!1,adddialogVisible:!1,titleName:"",othertitlename:"",flag:0,roleid:"",usernames:[],form:{roleName:""},rolerules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{max:10,message:"长度不得大于10个字符"}]},formLabelWidth:"100px",tableDatas:[],RoleTableName:"role",comfirmflag:"",rolecheck:[],tableColumns:[{type:"radio",align:"center",visible:!0,width:"50"},{field:"roleName",title:"角色名称",minWidth:"100",align:"center"},{field:"userList",title:"用户列表",minWidth:"300",align:"center",formatter:this.formatUser},{title:"操作",width:"120",align:"center",fixed:"right",slots:{default:function(i){var a=i.row;i.column;return[t("el-dropdown",{attrs:{placement:"bottom",size:"small"},on:{command:function(t){return e.handleCommand(t,a)}}},[t("span",{class:"operation-column"},["操作"]),t("el-dropdown-menu",{slot:"dropdown"},[t("el-dropdown-item",{class:"operation-column",attrs:{command:"setAuthority"}},["权限设置"]),t("el-dropdown-item",{class:"operation-column",attrs:{command:"addUser"}},["添加用户"]),t("el-dropdown-item",{class:"operation-column",attrs:{command:"modify"}},["修改"]),t("el-dropdown-item",{class:"operation-column",attrs:{command:"delete"}},["删除"])])])]}}}],tablePage:{total:0,currentPage:1,pageSize:10,pageSizes:[5,10,20,50,100,200,500],layouts:["Sizes","PrevJump","PrevPage","Number","NextPage","NextJump","FullJump","Total"],perfect:!0,slots:{left:"pager_left"}}}},components:{HeaderTitle:o["a"],HeadOperationItem:r["a"],VXETable:c["a"],roleOperation:k,SearchBox:C["a"],PageAuthoritySetting:y["a"]},methods:{buttonClickEvent:function(e){this["".concat(e)]()},showSearchCard:function(){this.isSearchBoxShow=!this.isSearchBoxShow},findList:function(){var e=this;this.tableLoading=!0;var t=this.tablePage,i=t.currentPage,a=t.pageSize,s={current:i,size:a};Object(w["c"])({},s).then((function(t){var i=t.rows;e.tableDatas=i,e.tablePage.total=t.total,setTimeout((function(){e.tableLoading=!1}),500)}))},onTablePageChange:function(e,t){this.tablePage.currentPage=e,this.tablePage.pageSize=t,this.findList()},modify:function(){var e={};if(!this.$refs.xGrid.getRadioRecord())return Object(N["c"])("请选择要操作的数据！"),!1;e=this.$refs.xGrid.getRadioRecord(),this.dialogVisible=!0,this.titleName="修改角色名称",this.comfirmflag="modify",this.form=Object(n["a"])({},e)},delete:function(){var e=this,t={};if(!this.$refs.xGrid.getRadioRecord())return Object(N["c"])("请选择要操作的数据！"),!1;t=this.$refs.xGrid.getRadioRecord(),t.userList.length>0?this.$message({message:"该数据下还有用户，不可删除",type:"warning"}):this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(w["b"])({ids:[t.roleId]}).then((function(t){e.$message({message:"删除成功",type:"success"}),e.findList()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},addRole:function(){this.dialogVisible=!0,this.comfirmflag="add",this.titleName="添加角色"},confirm:function(){var e=this;this.$refs.roleForm.validate((function(t){t&&("modify"===e.comfirmflag?Object(w["h"])(e.form).then((function(t){e.$message({message:"修改成功",type:"success"}),e.findList(),e.dialogVisible=!1})):"add"===e.comfirmflag&&Object(w["d"])(e.form).then((function(t){e.$message({message:"新增成功",type:"success"}),e.findList(),e.dialogVisible=!1})))}))},closeit:function(){this.$refs.roleForm.resetFields(),Object.assign(this.$data.form,this.$options.data().form),this.findList()},clearAddUserDialog:function(){this.cities.splice(0),this.checkedCities.splice(0),this.uids.splice(0)},adduser:function(){var e={};if(!this.$refs.xGrid.getRadioRecord())return Object(N["c"])("请选择要操作的数据！"),!1;e=this.$refs.xGrid.getRadioRecord(),this.adddialogVisible=!0,this.roleid=e.roleId,this.getUserData(e)},filterUser:function(e){return void 0!==this.allUsers.find((function(t){return t.userName===e.name}))},getUserData:function(e){var t=this;this.checkedCities=[];var i=this;Object(w["j"])({},{}).then((function(a){if(a.code===x["M"].OPERATION_SUCCESS){i.cities=a.rows;var s=[];if(e.userList.length>0){for(var l in e.userList)s.push(e.userList[l].userId);t.checkedCities=s}}}))},goBack:function(e,t){this.flag=e},rolesetting:function(){var e={};if(!this.$refs.xGrid.getRadioRecord())return Object(N["c"])("请选择要操作的数据！"),!1;e=this.$refs.xGrid.getRadioRecord(),this.roleid=e.roleId,this.flag=1,this.othertitlename="权限设置"},roleTableChooseCheck:function(e){this.rolecheck=e},deteleall:function(){var e=this;if(0===this.rolecheck.length)this.$message.error("请勾选后，再进行删除操作");else{var t=[];this.rolecheck.map((function(e){return t.push(e.roleId)})),this.$confirm("此操作将永久删除勾选数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(w["b"])({ids:t}).then((function(t){e.$message({message:"删除成功",type:"success"}),e.findList()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}},addUserConfirm:function(){var e=this,t={roleId:this.roleid};this.checkedCities.length>0&&(t.userIdList=this.checkedCities),console.log(t.userIdList),Object(w["i"])({},t).then((function(t){e.$message({message:"新增成功",type:"success"}),e.adddialogVisible=!1,e.findList()}))},allSelect:function(){},openCustomizeColumnsDialog:function(){var e,t=[],i=Object(l["a"])(this.tableColumns);try{for(i.s();!(e=i.n()).done;){var a=e.value;(a.field||"操作"===a.title)&&t.push({title:a.title,width:a.minWidth||"100",visible:!0,required:["角色名称","操作"].includes(a.title)})}}catch(n){i.e(n)}finally{i.f()}var s=JSON.stringify(t);this.$dialogCustomizeColumns.openDialog({isDialogShow:!0,tempTableColumns:JSON.parse(s),defaultTableColumns:JSON.parse(s)})},handleCommand:function(e,t){switch(e){case"setAuthority":this.rolesetting(t);break;case"addUser":this.adduser(t);break;case"modify":this.modify(t);break;case"delete":this.delete(t);break;default:break}},formatUser:function(e){var t=e.cellValue,i=[];for(var a in t)t[a].realName?i.push(t[a].realName):i.push(t[a].userName);return i.join("、")},refreshParentMenu:function(){this.$parent.$parent.$parent.getNavListData()}},created:function(){this.findList()}},O=S,P=O,L=(i("1732"),i("ad9b"),Object(p["a"])(P,a,s,!1,null,"6d84694a",null));t["default"]=L.exports},cad9:function(e,t,i){}}]);
//# sourceMappingURL=chunk-76f26c98.75b51ba3.js.map