(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4def4b88"],{"13d5":function(e,t,n){"use strict";var i=n("23e7"),r=n("d58f").left,o=n("a640"),a=n("ae40"),c=o("reduce"),u=a("reduce",{1:0});i({target:"Array",proto:!0,forced:!c||!u},{reduce:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"4cb7":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"kanban_page"},[n("div",{staticClass:"title"},[e._v("综合指标")]),n("div",{staticClass:"device_effciency"},[n("div",{staticClass:"kanban_module_title"},[e._v("设备效率")]),n("div",{ref:"effciency",staticClass:"effciency_charts"})]),n("div",{staticClass:"device_state"},[n("div",{staticClass:"kanban_module_title"},[e._v("今日设备状态")]),n("div",{ref:"state",staticClass:"state_charts"})])])},r=[],o=(n("99af"),n("4160"),n("a15b"),n("d81d"),n("13d5"),n("fb6a"),n("b0c0"),n("a9e3"),n("b680"),n("4d63"),n("ac1f"),n("25f0"),n("5319"),n("159b"),n("96cf"),n("1da1")),a=n("cf45"),c=n("99f6"),u=n("582a"),s=n("7598"),d={name:"distribute",data:function(){return{kanbanConfig:{},devLbIndex:0,devList:[],current:1,size:6,currentTime:0,dataTime:0}},created:function(){document.documentElement.style.fontSize=Object(a["b"])()+"px",window.onresize=function(){document.documentElement.style.fontSize=Object(a["b"])()+"px"},c["m"][this.getUrlKeyMain("cid",window.location.href)]&&(this.kanbanConfig=c["m"][this.getUrlKeyMain("cid",window.location.href)])},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getDataTime(),e.draweffciencyChart(),e.getDeviceData(),e.getDeviceState(),e.timer=setInterval((function(){e.draweffciencyChart(),e.getDeviceData(),e.getDeviceState()}),(null===(n=e.kanbanConfig)||void 0===n?void 0:n.time)||15e3),setInterval((function(){e.getDataTime()}),3e4);case 6:case"end":return t.stop()}}),t)})))()},methods:{getSearchToday:function(e){var t=new Date(this.dataTime-864e5*e),n=t.getFullYear(),i=t.getMonth()+1,r=t.getDate();return i=i<10?"0"+i:i,r=r<10?"0"+r:r,[n,i,r].join("-")},getTodayFirstDay:function(){var e=new Date(this.dataTime),t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate();return n=n<10?"0"+n:n,i=i<10?"0"+i:i,[t,n,i].join("-")+" 00:00:00"},getTodayLastDay:function(){var e=new Date(this.dataTime),t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate();return n=n<10?"0"+n:n,i=i<10?"0"+i:i,[t,n,i].join("-")+" 23:59:59"},hexToRgba:function(e,t){var n="",i=/^#[\da-f]{6}$/i;return i.test(e)&&(n="rgba(".concat(parseInt("0x"+e.slice(1,3)),",").concat(parseInt("0x"+e.slice(3,5)),",").concat(parseInt("0x"+e.slice(5,7)),",").concat(t,")")),n},draweffciencyChart:function(e,t,n,i){var r={grid:{left:"2%",right:"2%",bottom:"10%",top:"15%",containLabel:!0},title:{text:i,padding:Object(a["b"])(10),left:Object(a["b"])(30),textStyle:{color:"#fff",fontSize:Object(a["b"])(18)}},tooltip:{show:!0,trigger:"axis"},legend:{show:!0,right:Object(a["b"])(40),icon:"rect",itemWidth:Object(a["b"])(30),itemHeight:Object(a["b"])(10),textStyle:{fontSize:Object(a["b"])(18),color:"#ffffff"}},xAxis:{name:"",type:"category",boundaryGap:!1,data:n,axisLabel:{fontSize:Object(a["b"])(18)},axisTick:{show:!1},axisLine:{show:!0,lineStyle:{color:"#2077A3"}},nameTextStyle:{fontSize:Object(a["b"])(18)}},yAxis:{name:"",type:"value",axisLine:{show:!0,lineStyle:{color:"#2077A3"}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{fontSize:Object(a["b"])(18)},nameTextStyle:{fontSize:Object(a["b"])(18)}},textStyle:{color:"#929EE6"},series:[{name:"平均效率",type:"line",zlevel:1,showSymbol:!1,color:"#36CE9E",lineStyle:{normal:{color:"#36CE9E",shadowBlur:3}},emphasis:{focus:"series"},data:t},{name:"设备效率",type:"line",zlevel:1,smooth:!0,lineStyle:{width:0},color:"#0C49C0",showSymbol:!1,areaStyle:{opacity:.6,color:"#0C49C0"},emphasis:{focus:"series"},data:e}]},o=this.$echarts.init(this.$refs.effciency);o.setOption(r)},drawStateChart:function(e,t,n,i,r){var o={xdata:r,result:[{name:"运行",data:e},{name:"告警",data:i},{name:"空闲",data:t},{name:"离线",data:n}]},c=function(e,t){var n=0;return o.result.slice(0,e+1).forEach((function(e){n+=e.data[t]})),n},u=o.result.reduce((function(e,t,n){return e[n]=t.data.map((function(e,t){return 0===n?e:e?c(n,t):e})),e}),[]),s=[[{offset:0,color:"#0C66FF"},{offset:1,color:"#18C5FF"}],[{offset:0,color:"#FF0C0C"},{offset:1,color:"#FB586B"}],[{offset:0,color:"#FFE00C"},{offset:1,color:"#FDE576"}],[{offset:0,color:"#696969"},{offset:1,color:"#C1C1C1"}]],d=o.result.reduce((function(e,t,n,i){return e.push({z:n+1,stack:"总量",type:"bar",name:t.name,barGap:"-100%",barWidth:30,data:t.data,itemStyle:{color:{type:"linear",x:0,x2:1,y:0,y2:0,colorStops:s[n]}}},{z:n+10,type:"pictorialBar",symbolPosition:"end",symbol:"diamond",symbolOffset:[0,"-50%"],symbolSize:[30,10],data:u[n],itemStyle:{color:{type:"linear",x:0,x2:1,y:0,y2:0,colorStops:s[n]}},tooltip:{show:!1}}),e.length===2*i.length?(e.push({z:2*i.length,type:"pictorialBar",symbolPosition:"start",data:o.result[0].data,symbol:"diamond",symbolOffset:["0%","50%"],symbolSize:[30,10],itemStyle:{color:{type:"linear",x:0,x2:1,y:0,y2:0,colorStops:s[0]}},tooltip:{show:!1}}),e):e}),[]),f={grid:{left:"2%",right:"2%",bottom:"10%",top:"15%",containLabel:!0},tooltip:{trigger:"axis"},legend:{data:o.result.map((function(e){return e.name})),textStyle:{fontSize:Object(a["b"])(18),color:"#fff"},itemWidth:Object(a["b"])(30),itemHeight:Object(a["b"])(15),itemGap:Object(a["b"])(15),right:Object(a["b"])(30),selectedMode:!1},xAxis:{axisTick:{show:!0},axisLine:{show:!0,lineStyle:{color:"#2077A3"}},axisLabel:{textStyle:{fontSize:Object(a["b"])(18),color:"#fff"}},data:o.xdata},yAxis:{axisLine:{show:!0,lineStyle:{color:"#2077A3"}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{textStyle:{fontSize:Object(a["b"])(18),color:"#fff"}}},series:d},l=this.$echarts.init(this.$refs.state);l.setOption(f)},getDeviceData:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.devList.length&&e.devLbIndex!==e.devList.length-1){t.next=14;break}return t.prev=1,n={secretKey:e.kanbanConfig.key,conditionJson1:[{column:"isProductionDevice",operator:1,ptype:"int",type:"eq",value:1}]},t.next=5,Object(s["g"])({current:1,size:99999,startTime:e.getTodayFirstDay(),endTime:e.getTodayLastDay()},n);case 5:i=t.sent,i.code===u["M"].OPERATION_SUCCESS&&(e.devList=i.rows,e.getDeviceTimeRecentDayUtilization(),e.devLbIndex=0),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log(t.t0);case 12:t.next=16;break;case 14:e.getDeviceTimeRecentDayUtilization(),e.devLbIndex++;case 16:case"end":return t.stop()}}),t,null,[[1,9]])})))()},getDeviceTimeRecentDayUtilization:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,i,r,o,a,c,d,f,l,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n={conditionJson1:[{column:"deviceCode",operator:1,ptype:"string",type:"eq",value:e.devList[e.devLbIndex].deviceCode}],secretKey:e.kanbanConfig.key},t.next=4,Object(s["i"])({startTime:e.getSearchToday(7)+" 00:00:00",endTime:e.getSearchToday(0)+" 23:59:59"},n);case 4:if(i=t.sent,i.code===u["M"].OPERATION_SUCCESS){for(r=[],o=[],a=[],c=[],d=0,f=0;f<i.rows.length;f++)r.push(Number((100*i.rows[f].value).toFixed(2))),a.push(e.formatDateThree(i.rows[f].time)),c.push(Number((100*i.rows[f].value).toFixed(2))),d+=i.rows[f].value;for(l=(d/c.length*100).toFixed(2),p=0;p<c.length;p++)o.push(Number(l));e.draweffciencyChart(r,o,a,e.devList[e.devLbIndex].deviceName)}t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},getDeviceState:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,i,r,o,a,c,d,f,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={secretKey:e.kanbanConfig.key,conditionJson1:[{column:"isProductionDevice",operator:1,ptype:"int",type:"eq",value:1}]},t.prev=1,t.next=4,Object(s["g"])({current:e.current,size:e.size,startTime:e.getTodayFirstDay(),endTime:e.getTodayLastDay()},n);case 4:if(i=t.sent,i.code===u["M"].OPERATION_SUCCESS){for(e.current*e.size>=i.total?e.current=1:e.current++,r=[],o=[],a=[],c=[],d=[],f=0;f<i.rows.length;f++)l=i.rows[f].deviceLiveReportVo.runTimeSum+i.rows[f].deviceLiveReportVo.idleTimeSum+i.rows[f].deviceLiveReportVo.offlineTimeSum+i.rows[f].deviceLiveReportVo.warnTimeSum,r.push(i.rows[f].deviceLiveReportVo.runTimeSum/l*100),a.push(i.rows[f].deviceLiveReportVo.offlineTimeSum/l*100),o.push(i.rows[f].deviceLiveReportVo.idleTimeSum/l*100),c.push(i.rows[f].deviceLiveReportVo.warnTimeSum/l*100),d.push(i.rows[f].deviceName);e.drawStateChart(r,o,a,c,d)}t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},getUrlKeyMain:function(e,t){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||["",""])[1].replace(/\+/g,"%20"))||null},formatDateThree:function(e){var t="",n="";t=new Date(e);var i=t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate();return n=i+"-"+r,n},getDataTime:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(s["F"])({},{});case 3:n=t.sent,e.dataTime=n.rows,console.log(n),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}},f=d,l=(n("e8ed"),n("2877")),p=Object(l["a"])(f,i,r,!1,null,"030b95de",null);t["default"]=p.exports},7598:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"i",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"h",(function(){return f})),n.d(t,"s",(function(){return l})),n.d(t,"y",(function(){return p})),n.d(t,"x",(function(){return v})),n.d(t,"w",(function(){return g})),n.d(t,"H",(function(){return b})),n.d(t,"I",(function(){return y})),n.d(t,"j",(function(){return m})),n.d(t,"m",(function(){return h})),n.d(t,"k",(function(){return T})),n.d(t,"l",(function(){return w})),n.d(t,"o",(function(){return O})),n.d(t,"J",(function(){return k})),n.d(t,"t",(function(){return x})),n.d(t,"E",(function(){return j})),n.d(t,"A",(function(){return S})),n.d(t,"F",(function(){return R})),n.d(t,"z",(function(){return D})),n.d(t,"p",(function(){return C})),n.d(t,"n",(function(){return L})),n.d(t,"v",(function(){return B})),n.d(t,"u",(function(){return E})),n.d(t,"a",(function(){return z})),n.d(t,"C",(function(){return F})),n.d(t,"r",(function(){return M})),n.d(t,"q",(function(){return A})),n.d(t,"G",(function(){return I})),n.d(t,"D",(function(){return _})),n.d(t,"B",(function(){return U}));var i=n("b775"),r=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getDeviceRealState.action?",e,t)},o=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getDeviceStateReportStatistics.action?",e,t)},a=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceManager/getCheckCount.action?",e,t)},c=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceManager/getRepairTaskCount.action?",e,t)},u=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceManager/getMaintainTaskCount.action?",e,t)},s=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceReport/getDeviceDayUtilization.action?",e,t)},d=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceEarlyWarning/getDeviceWarnRecord.action?",e,t)},f=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getPageByDevice.action?",e,t)},l=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getDeviceMonitorReport.action?",e,t)},p=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getGasHoursUseReportBoard.action?",e,t)},v=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getEnergyTodayUse.action?",e,t)},g=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getEnergyTodayAndWeek.action?",e,t)},b=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getTodayAndYesterdayElectricityRecord.action?",e,t)},y=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getTopTenElectricityDevices.action?",e,t)},m=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getElectricityEnergyReport.action?",e,t)},h=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getWaterEnergyReport.action?",e,t)},T=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getGasEnergyReport.action?",e,t)},w=function(e,t){return Object(i["k"])("open-api/TvBoard/energyReport/getRecentDayEnergyRecord.action?",e,t)},O=function(e,t){return Object(i["k"])("realUserWork/getAndonKanbanOfRiSheng.action?",e,t)},k=function(e,t,n){return Object(i["k"])("existFunctionUpdate/listDeviceExceptionCount.action",e,t,n)},x=function(e,t,n){return Object(i["k"])("open-api/TvBoard/deviceReport/getDeviceStateReportStatistics.action?",e,t,n)},j=function(e,t,n){return Object(i["k"])("open-api/TvBoard/deviceManager/getRepairTask.action?",e,t,n)},S=function(e,t,n){return Object(i["k"])("open-api/TvBoard/deviceManager/getMaintainTask.action?",e,t,n)},R=function(e,t,n){return Object(i["d"])("open-api/getTime.action?",e,t,n)},D=function(e,t,n){return Object(i["k"])("open-api/getGroupTree.action?",e,t,n)},C=function(e,t,n){return Object(i["k"])("open-api/TvBoard/deviceManager/getConfigurationByEnum.action?",e,t,n)},L=function(e,t,n){return Object(i["k"])("open-api/TvBoard/device/getAllGroupAndDevice.action?",e,t,n)},B=function(e,t,n){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getDeviceTimeFluctuationRate.action?",e,t,n)},E=function(e,t,n){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getDeviceTimeCapacityAndEnergyEfficiency.action?",e,t,n)},z=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getOneDayDetailStateClockInfo.action?",e,t)},F=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceReport/getOneDayDetailStateClock.action?",e,t)},M=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getDeviceInfo.action?",e,t)},A=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getDeviceHoursEffTrend.action?",e,t)},I=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getTimeDayTypeProduction.action?",e,t)},_=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceReport/getQueryDeviceStateTimeUtilization.action?",e,t)},U=function(e,t){return Object(i["k"])("open-api/TvBoard/deviceRealLive/getManyDeviceTimeFluctuationRate.action?",e,t)}},d58f:function(e,t,n){var i=n("1c0b"),r=n("7b0b"),o=n("44ad"),a=n("50c4"),c=function(e){return function(t,n,c,u){i(n);var s=r(t),d=o(s),f=a(s.length),l=e?f-1:0,p=e?-1:1;if(c<2)while(1){if(l in d){u=d[l],l+=p;break}if(l+=p,e?l<0:f<=l)throw TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:f>l;l+=p)l in d&&(u=n(u,d[l],l,s));return u}};e.exports={left:c(!1),right:c(!0)}},d9d4:function(e,t,n){},e8ed:function(e,t,n){"use strict";var i=n("d9d4"),r=n.n(i);r.a}}]);
//# sourceMappingURL=chunk-4def4b88.ccc5c7b7.js.map