(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-223136f6"],{"0063":function(e,t,a){},"01f6":function(e,t,a){"use strict";var i=a("4ce3"),r=a.n(i);r.a},"042b":function(e,t,a){"use strict";var i=a("c52c"),r=a.n(i);r.a},1647:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"fix-task-confirm",attrs:{width:"50%",title:e.title,visible:e.showModalFlag,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showModalFlag=t},closed:e.cancelAction}},[e.requiredData?a("el-form",{ref:"confirmDataForm",attrs:{model:e.requiredData,rules:e.confirmRules}},[a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.REPAIR_TASK.PREPIR_CODE,"label-width":e.formLabelWidth}},[a("el-input",{staticClass:"filter-input",attrs:{placeholder:"",disabled:!0},model:{value:e.requiredData.repairCode,callback:function(t){e.$set(e.requiredData,"repairCode",t)},expression:"requiredData.repairCode"}})],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.REPAIR_TASK.ADD_USER,"label-width":e.formLabelWidth}},[a("el-input",{staticClass:"filter-input",attrs:{placeholder:"",disabled:!0},model:{value:e.requiredData.maintainUserName,callback:function(t){e.$set(e.requiredData,"maintainUserName",t)},expression:"requiredData.maintainUserName"}})],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.ENERGY.FACTORY,"label-width":e.formLabelWidth}},[a("el-input",{staticClass:"filter-input",attrs:{placeholder:"",disabled:!0},model:{value:e.requiredData.factory,callback:function(t){e.$set(e.requiredData,"factory",t)},expression:"requiredData.factory"}})],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.ENERGY.WORKSHOP,"label-width":e.formLabelWidth}},[a("el-input",{staticClass:"filter-input",attrs:{placeholder:"",disabled:!0},model:{value:e.requiredData.workshop,callback:function(t){e.$set(e.requiredData,"workshop",t)},expression:"requiredData.workshop"}})],1)],1)],1),a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.ENERGY.PRODUCTION_LINE,"label-width":e.formLabelWidth}},[a("el-input",{staticClass:"filter-input",attrs:{placeholder:"",disabled:!0},model:{value:e.requiredData.productionLine,callback:function(t){e.$set(e.requiredData,"productionLine",t)},expression:"requiredData.productionLine"}})],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.EQUIPMENT_LIVE.DEVICE_NAME,"label-width":e.formLabelWidth,prop:"deviceName"}},[a("el-input",{staticClass:"filter-input",attrs:{placeholder:"",disabled:!0},model:{value:e.requiredData.deviceName,callback:function(t){e.$set(e.requiredData,"deviceName",t)},expression:"requiredData.deviceName"}})],1)],1)],1),a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.EQUIPMENT_LIVE.DEVICE_NO,"label-width":e.formLabelWidth,prop:"devicePriCode"}},[a("el-input",{staticClass:"filter-input",attrs:{placeholder:"",disabled:!0},model:{value:e.requiredData.devicePriCode,callback:function(t){e.$set(e.requiredData,"devicePriCode",t)},expression:"requiredData.devicePriCode"}})],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.EQUIPMENT_DATA.OCCURTIME,"label-width":e.formLabelWidth,prop:"occurTime"}},[a("el-input",{staticClass:"filter-input",attrs:{placeholder:"",disabled:!0},model:{value:e.requiredData.occurTime,callback:function(t){e.$set(e.requiredData,"occurTime",t)},expression:"requiredData.occurTime"}})],1)],1)],1),a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"维修类别","label-width":e.formLabelWidth}},[a("el-select",{model:{value:e.requiredData.repairTaskType,callback:function(t){e.$set(e.requiredData,"repairTaskType",t)},expression:"requiredData.repairTaskType"}},e._l(e.repairTaskTypeData,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"是否停机","label-width":e.formLabelWidth}},[a("el-select",{model:{value:e.requiredData.extend18,callback:function(t){e.$set(e.requiredData,"extend18",t)},expression:"requiredData.extend18"}},e._l(e.extend18Data,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.EQUIPMENT_DATA.REPAIR_TYPENAMELIST,"label-width":e.formLabelWidth,prop:"repairTypeIdList"}},[a("el-select",{attrs:{multiple:"",disabled:!0,placeholder:e.MSG.PLEASE_CHOOSE},model:{value:e.requiredData.repairTypeIdList,callback:function(t){e.$set(e.requiredData,"repairTypeIdList",t)},expression:"requiredData.repairTypeIdList"}},e._l(e.$store.state.filters.repairTypeData,(function(e){return a("el-option",{key:e.repairName,attrs:{label:e.repairName,value:e.repairTypeId}})})),1)],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.EQUIPMENT_DATA.REPAIR_STARTTIME,"label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:e.EQUIPMENT_DATA.PLESE_SELECT_DATE,disabled:e.readOnly},model:{value:e.requiredData.startTime,callback:function(t){e.$set(e.requiredData,"startTime",t)},expression:"requiredData.startTime"}})],1)],1)],1),a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.EQUIPMENT_DATA.CONFIRM_REPAIR_ISSUE,"label-width":e.formLabelWidth,prop:"confirmRepairType"}},[a("el-select",{attrs:{multiple:"",disabled:e.readOnly,placeholder:e.EQUIPMENT_DATA.PLEASE_CHOOSE_CONTENT},on:{change:function(t){return e.test(t)}},model:{value:e.requiredData.confirmRepairType,callback:function(t){e.$set(e.requiredData,"confirmRepairType",t)},expression:"requiredData.confirmRepairType"}},e._l(e.$store.state.filters.repairTypeData,(function(e){return a("el-option",{key:e.repairName,attrs:{label:e.repairName,value:e.repairTypeId}})})),1)],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.EQUIPMENT_DATA.REPAIR_ENDTIME,"label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{disabled:e.readOnly,type:"datetime",placeholder:e.EQUIPMENT_DATA.PLESE_SELECT_DATE},model:{value:e.requiredData.endTime,callback:function(t){e.$set(e.requiredData,"endTime",t)},expression:"requiredData.endTime"}})],1)],1)],1),a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:e.EQUIPMENT_DATA.REPAIR_USER,"label-width":e.formLabelWidth,prop:"userIdList"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.readOnly,multiple:"",placeholder:e.MSG.PLEASE_ENTER_CONTENT},on:{change:function(t){return e.test(t)}},model:{value:e.requiredData.userIdList,callback:function(t){e.$set(e.requiredData,"userIdList",t)},expression:"requiredData.userIdList"}},e._l(e.$store.state.filters.userData,(function(e){return a("el-option",{key:e.realName,attrs:{label:e.realName,value:e.userId}})})),1)],1)],1),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:e.REPAIR_TASK.DESCRIPTION,"label-width":e.formLabelWidth}},[a("el-input",{staticClass:"filter-input",attrs:{type:"textarea",placeholder:"",disabled:!0},model:{value:e.requiredData.warrantyDescription,callback:function(t){e.$set(e.requiredData,"warrantyDescription",t)},expression:"requiredData.warrantyDescription"}})],1)],1),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:e.REPAIR_TASK.ANALYSIS,"label-width":e.formLabelWidth}},[a("el-input",{staticClass:"filter-input",attrs:{type:"textarea",placeholder:""},model:{value:e.requiredData.reasonContent,callback:function(t){e.$set(e.requiredData,"reasonContent",t)},expression:"requiredData.reasonContent"}})],1)],1)],1),e.extendPropertyValueVoList&&e.extendPropertyValueVoList.length>0?a("el-row",{attrs:{gutter:22}},e._l(e.extendPropertyValueVoList,(function(t,i){return a("el-col",{key:i,attrs:{span:11}},[a("el-form-item",{class:{requiredStar:1===t.propertyIsNull},attrs:{label:t.extendName,"label-width":e.formLabelWidth,prop:"extendPropertyValueVoList."+i+".extendValue",rules:e.confirmRules[t.propertyCode]}},[3!==t.propertyType?a("el-input",{on:{input:function(t){return e.change(t)}},model:{value:t.extendValue,callback:function(a){e.$set(t,"extendValue",a)},expression:"item.extendValue"}}):a("el-date-picker",{attrs:{type:"datetime",format:e.FORM_CONFIG_DATE[t.propertyLength],"value-format":e.FORM_CONFIG_DATE[t.propertyLength]},on:{input:function(a){return e.datetimeChange(t,a)}},model:{value:t.extendValue,callback:function(a){e.$set(t,"extendValue",a)},expression:"item.extendValue"}})],1)],1)})),1):e._e(),a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:e.REPAIR_TASK.ADD_PIC,"label-width":e.formLabelWidth}},e._l(e.requiredData.repairDescriptionImageList,(function(t){return a("el-image",{key:t.resourceId,staticStyle:{width:"80px",height:"80px"},attrs:{src:e.IP.PUBLICIP+t.fileUrl,fit:"fill"},on:{click:function(a){return e.showDialgImg(e.IP.PUBLICIP+t.fileUrl)}}})})),1)],1),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:e.REPAIR_TASK.REPAIR_PIC,"label-width":e.formLabelWidth}},[a("div",{staticClass:"uploadDiv"},[a("el-upload",{ref:"upload",attrs:{"list-type":"picture-card",accept:".JPG, .PNG, .JPEG,.jpg, .png, .jpeg",headers:e.uploadConfig.headers,action:e.uploadConfig.url,data:e.uploadConfig.dataImg,"before-upload":e.updateFilesImg,"file-list":e.fileListImg,"on-success":e.updateSuccess,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,disabled:e.isCanUpload}},[a("i",{staticClass:"el-icon-plus"})])],1)])],1)],1)],1):e._e(),e.showFileHandle?a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:22}},[a("span",{staticClass:"content-label upload-label"},[e._v(e._s(e.EQUIPMENT_DATA.ATTACHMENT))]),a("div",{staticClass:"content-detail content-upload"},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{multiple:"",disabled:e.isCanUpload,headers:e.uploadConfig.headers,action:e.uploadConfig.url,data:e.uploadConfig.data,"on-success":e.handleUploadSuccess,"on-change":e.updateFiles,"show-file-list":!1,"auto-upload":!0,limit:100}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v(e._s(e.EQUIPMENT_DATA.SELECT_FILE))])],1),a("vxe-table",{ref:"xTable",attrs:{border:"","show-overflow":"",height:"200",data:e.tableData,"edit-config":{trigger:"click",mode:"cell"}}},[a("vxe-table-column",{attrs:{type:"seq",width:"60"}}),a("vxe-table-column",{attrs:{field:"name",title:e.EQUIPMENT_DATA.FILE_NAME},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(" "+e._s(i.name)+" "),100==i.percentage||i.fileUrl?e._e():a("el-progress",{attrs:{percentage:i.percentage}})]}}],null,!1,2323346430)}),a("vxe-table-column",{attrs:{title:e.BTN_TEXT.OPERATION},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.downloadFile(i)}},nativeOn:{click:function(e){e.preventDefault()}}},[e._v(e._s(e.BTN_TEXT.DOWNLOAD))]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteFileById(i.resourceId)}},nativeOn:{click:function(e){e.preventDefault()}}},[e._v(e._s(e.BTN_TEXT.DELETE))])]}}],null,!1,608177261)})],1)],1)])],1):e._e(),a("el-row",{staticStyle:{"margin-top":"15px"},attrs:{gutter:24}},[a("el-col",{attrs:{span:2}},[a("div",{staticStyle:{width:"80px",height:"40px"}})]),a("el-col",{attrs:{span:24}},[a("vxe-table",{ref:"repairItemTable",staticStyle:{"margin-left":"0px"},attrs:{border:"","show-header-overflow":"","show-overflow":"","highlight-hover-row":"",stripe:"","max-height":"288","edit-config":{trigger:"click",mode:"cell"},loading:e.tableLoading,"highlight-current-row":"",data:e.taskProcessRecordVoList}},[a("vxe-table-column",{attrs:{type:"seq",width:"60",align:"center",title:e.REPAIR_TASK.SEQ}}),a("vxe-table-column",{attrs:{field:"processTypeName",align:"center",title:e.REPAIR_TASK.PROCESS_TYPE_NAME}}),a("vxe-table-column",{attrs:{field:"realName",align:"center",title:e.REPAIR_TASK.REALNAME}}),a("vxe-table-column",{attrs:{field:"remark",align:"center",title:e.REPAIR_TASK.REMARK}}),a("vxe-table-column",{attrs:{field:"recordTime",align:"center",title:e.REPAIR_TASK.RECORD_TIME}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:1===e.dataset.isChargeback,expression:"dataset.isChargeback === 1"}],attrs:{type:"danger"},on:{click:function(t){return e.publicFun(2)}}},[e._v(e._s(e.BTN_TEXT.CHARGEBACK))]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1===e.dataset.isRevoke,expression:"dataset.isRevoke === 1"}],attrs:{type:"danger"},on:{click:function(t){return e.publicFun(3)}}},[e._v(e._s(e.BTN_TEXT.REVOKE))]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1===e.dataset.isReview,expression:"dataset.isReview === 1"}],attrs:{type:"success"},on:{click:function(t){return e.publicFun(4)}}},[e._v(e._s(e.BTN_TEXT.PASS))]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1===e.dataset.isReject,expression:"dataset.isReject === 1"}],attrs:{type:"danger"},on:{click:function(t){return e.publicFun(5)}}},[e._v(e._s(e.BTN_TEXT.REJECT))]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.saveBtnshow(),expression:"saveBtnshow()"}],attrs:{type:"primary"},on:{click:e.checkDataCorrect}},[e._v(e._s(e.BTN_TEXT.SAVE))]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.confirmBtnshow(),expression:"confirmBtnshow()"}],attrs:{type:"primary"},on:{click:e.repairConfirm}},[e._v(e._s(e.BTN_TEXT.CONFIRM_REPAIR))]),a("el-button",{on:{click:e.cancelAction}},[e._v(e._s(e.BTN_TEXT.CANCEL))])],1)],1)},r=[],n=(a("caad"),a("a15b"),a("d81d"),a("a9e3"),a("d3b7"),a("ac1f"),a("3ca3"),a("5319"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),s=a("582a"),o=a("17cb"),c=a("6a2c"),l=a("3fa5"),u=a("6464"),d=a("786f"),p=a("b58d"),h=a("f564"),f=a("e072"),m=a("c1df"),T=a.n(m),g={name:"FixTaskConfirmTaskModal",props:{title:{type:String,default:""},cancelLabel:{type:String,default:s["c"].CANCEL},confirmLabel:{type:String,default:s["c"].CONFIRM_FINISH},backLabel:{type:String,default:s["c"].RETURN},showDialog:{type:Boolean,default:!1},isCanUpload:{type:Boolean,default:!1},input:{type:String,default:""},tabs:{type:Array,default:[]},active2:{type:Number,default:0},dataset:{type:Object,default:function(){return{isGrabMonad:0,isChargeback:0,isRevoke:0,isReview:0,isReject:0,isSave:0,isSubmitReview:0}}},requiredData:{type:Object,default:function(){}},showFileHandle:{type:Boolean,default:!0},handleCancel:Function,handleConfirm:Function,handleClose:Function,handleShowImg:Function,publicFun:Function,readOnly:{type:Boolean,default:!1}},data:function(){var e=this,t=function(t,a,i){return e.$options.filters.formatterFormValidate(t,a,i,e.extendPropertyValueVoList)};return{setValidateForm:t,REPAIR_TASK:s["L"],IP:s["E"],ENERGY:s["q"],FORM_CONFIG_DATE:s["D"],EQUIPMENT_LIVE:s["t"],MSG:s["H"],CONSTANTS_DEVICE_CONFIGURATION:s["i"],EQUIPMENT_DATA:s["s"],BTN_TEXT:s["c"],reasonContent:"",tableData:[],formLabelWidth:"135px",showModalFlag:!1,extendPropertyValueVoList:[],uploadConfig:{headers:{token:window.localStorage.getItem("token").replace(/"/g,"")},url:s["E"].PUBLICIP+"fileResource/uploadOneFile.action",data:{fileResourceTypeEnum:this.GLOBAL.FILE_TYPE.REPAIR_FILE,relationshipId:""},dataImg:{fileResourceTypeEnum:s["z"].REPAIR_IMAGE,relationshipId:""}},confirmRules:{startTime:[{required:!0,message:s["H"].PLEASE_ENTER_CONTENT}],confirmRepairType:[{required:!0,message:s["H"].PLEASE_ENTER_CONTENT}],endTime:[{required:!0,message:s["H"].PLEASE_ENTER_CONTENT}],userIdList:[{required:!0,message:s["H"].PLEASE_ENTER_CONTENT}]},fileListImg:[],delFileList:[],taskProcessRecordVoList:[],tableLoading:!1,repairTaskTypeData:[],extend18Data:[]}},methods:{saveBtnshow:function(e){var t=!1;return 1===this.dataset.isSave&&(t=!0),2===this.active2&&1===this.requiredData.repairState&&(t=!0),t},confirmBtnshow:function(){var e=!1;return 1!==this.dataset.isSubmitReview&&0!==this.dataset.isSubmitReview||(e=!0),2===this.active2&&1===this.requiredData.repairState&&(e=!0),e},datetimeChange:function(e,t){var a=this;e.extendValue=t,a.$forceUpdate()},change:function(e){this.$forceUpdate()},test:function(e){},initData:function(){this.toExtendRulesAndShow(this.requiredData),this.requiredData.startTime||(this.requiredData.startTime=this.requiredData.occurTime),this.requiredData&&(3===this.requiredData.repairState?this.isCanUpload=!0:this.isCanUpload=!1,this.uploadConfig.data.relationshipId=this.requiredData.repairTaskId,this.uploadConfig.dataImg.relationshipId=this.requiredData.repairTaskId,this.taskProcessRecordVoList=this.requiredData.taskProcessRecordVoList,this.fileListImg=this.requiredData.repairImageList.map((function(e){var t={id:e.resourceId,url:s["E"].PUBLICIP+e.fileUrl,relationshipId:e.relationshipId,flag:!0};return t}))),this.showFileHandle&&this.requiredData&&this.requiredData.repairTaskId&&this.getFilesData(),o["a"].getUsers()},getFilesData:function(){var e=this;Object(h["gb"])({fileResourceTypeEnum:this.GLOBAL.FILE_TYPE.REPAIR_FILE,relationshipId:this.requiredData.repairTaskId}).then((function(t){t.code===e.GLOBAL.STATUS_CODE.OPERATION_SUCCESS&&(e.tableData=c["a"].generateFixTaskFileData(t.rows))}))},downloadFile:function(e){Object(h["m"])({fileUrl:e.fileUrl}).then((function(t){var a=e.fileName,i=new Blob([t]),r=document.createElement("a"),n=window.URL.createObjectURL(i);r.href=n,r.download=a,r.click(),document.body.removeChild(r)}))},handleUploadSuccess:function(e,t,a){e.code===this.GLOBAL.STATUS_CODE.OPERATION_SUCCESS?(this.getFilesData(),this.$refs.upload.uploadFiles=[]):Object(l["c"])(e.message)},deleteFileById:function(e){var t=this;Object(h["i"])({id:e}).then((function(e){t.tableData=[],t.getFilesData()}))},cancelAction:function(){if(this.handleCancel){var e=this;setTimeout((function(){e.handleCancel()}))}},saveRepairData:function(){var e=this,t=JSON.parse(JSON.stringify(this.requiredData));t.fileList=this.fileList,t.startTime=this.requiredData.startTime?T()(this.requiredData.startTime).format("YYYY-MM-DD HH:mm:ss"):null,t.endTime=T()((new Date).getTime()).format("YYYY-MM-DD HH:mm:ss"),t.repairUserIdList=this.requiredData.userIdList,t.repairUserIds=this.requiredData.userIdList.join(",");var a={repairTaskId:t.repairTaskId,endTime:t.endTime,startTime:t.startTime,reasonContent:t.reasonContent?t.reasonContent:"",repairTypeIdList:this.requiredData.confirmRepairType,repairUserIdList:t.repairUserIdList};t.extend18&&(a.extend18=t.extend18),t.repairTaskType&&(a.repairTaskType=t.repairTaskType),Object(h["a"])(a).then((function(a){a.code===s["M"].OPERATION_SUCCESS?(t.extendPropertyValueVoList.length>0&&e.saveExtendValue(t.extendPropertyValueVoList),0!==e.delFileList.length&&e.delImg(),setTimeout((function(){Object(l["b"])(a.message),e.handleConfirm(),e.clearData()}),300)):Object(l["c"])(a.message)})).catch((function(e){Object(u["a"])(e)}))},saveConfirmRepairData:function(){var e=this,t=JSON.parse(JSON.stringify(this.requiredData));t.fileList=this.fileList,t.startTime=this.requiredData.startTime?T()(this.requiredData.startTime).format("YYYY-MM-DD HH:mm:ss"):null,t.endTime=T()((new Date).getTime()).format("YYYY-MM-DD HH:mm:ss"),t.repairUserIdList=this.requiredData.userIdList,t.repairUserIds=this.requiredData.userIdList.join(",");var a={repairTaskId:t.repairTaskId,endTime:t.endTime,startTime:t.startTime,reasonContent:t.reasonContent?t.reasonContent:"",repairTypeIdList:this.requiredData.confirmRepairType,repairUserIdList:t.repairUserIdList};t.extend18&&(a.extend18=t.extend18),t.repairTaskType&&(a.repairTaskType=t.repairTaskType),Object(h["X"])(a).then((function(a){a.code===s["M"].OPERATION_SUCCESS?(t.extendPropertyValueVoList.length>0&&e.saveExtendValue(t.extendPropertyValueVoList),0!==e.delFileList.length&&e.delImg(),setTimeout((function(){e.handleConfirm(),e.clearData()}),300),Object(l["b"])(a.message)):Object(l["c"])(a.message)})).catch((function(e){Object(u["a"])(e)}))},saveExtendValue:function(e){var t=e.map((function(e){return null===e.extendValue&&(e.extendValue=""),e}));Object(d["b"])({},t).then((function(e){e.code===s["M"].OPERATION_SUCCESS||Object(l["c"])(e.message)})).catch((function(e){Object(u["a"])(e)}))},delImg:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(p["A"])({ids:e.delFileList},[]);case 3:a=t.sent,a.code===s["M"].OPERATION_SUCCESS?e.delFileList=[]:Object(l["c"])(a.message),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(u["a"])(s["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,null,[[0,7,10,12]])})))()},closeAction:function(){this.handleClose&&(this.clearData(),this.handleClose())},checkDataCorrect:function(){var e=this;this.$refs.confirmDataForm.validate((function(t){t&&e.saveRepairData()}))},repairConfirm:function(){var e=this;this.$refs.confirmDataForm.validate((function(t){t&&e.saveConfirmRepairData()}))},updateFiles:function(){for(var e=0;e<this.$refs.upload.uploadFiles.length;e++){for(var t=!1,a=0;a<this.tableData.length;a++)this.tableData[a].uid===this.$refs.upload.uploadFiles[e].uid&&(t=!0);t||this.tableData.push(this.$refs.upload.uploadFiles[e])}},updateFilesImg:function(e){var t=["image/JPG","image/PNG","image/JPEG","image/jpeg","image/jpg","image/png"],a=t.includes(e.type);if(!a)return this.$message.error("上传图片只能是 JPG、JPEG、PNG 格式!"),!1;var i=e.size/1024/1024<5;return i?void 0:(this.$message.error("上传图片大小不能超过 5MB!"),!1)},clearData:function(){this.fileListImg=[],this.delFileList=[]},toExtendRulesAndShow:function(e){var t=e.extendPropertyValueVoList.map((function(t){return t.relationshipTypeId=e.repairTaskId,t.extendValue=t.extendValue?t.extendValue:null,t}));this.extendPropertyValueVoList=t;var a=JSON.parse(JSON.stringify(this.confirmRules));for(var i in this.extendPropertyValueVoList)3===this.extendPropertyValueVoList[i].propertyType?a[this.extendPropertyValueVoList[i].propertyCode]=[{validator:this.setValidateForm,trigger:["blur","change"]}]:a[this.extendPropertyValueVoList[i].propertyCode]=[{validator:this.setValidateForm,trigger:"blur"}];this.confirmRules=a},updateSuccess:function(e,t,a){this.fileListImg.push(t),e.code,this.GLOBAL.STATUS_CODE.OPERATION_SUCCESS},showDialgImg:function(e){this.handleShowImg(e)},handlePictureCardPreview:function(e){this.handleShowImg(e.url)},handleRemove:function(e,t){e.flag?(this.delFileList.push(e.id),this.fileListImg=t):(this.delFileList.push(e.response.rows.resourceId),this.fileListImg=t)},saveRepairImg:function(e,t){for(var a=[],i=0;i<t.length;i++){var r={relationshipId:e,resourceId:t[i]};a.push(r)}Object(h["n"])({},a).then((function(e){e.code===s["M"].OPERATION_SUCCESS||Object(l["c"])(e.message)})).catch((function(e){Object(u["a"])(e)}))},getRepairTaskTypeData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(f["c"])({basicInformationEnum:"REPAIR_TASK_TYPE"});case 3:if(a=t.sent,a.code===s["M"].OPERATION_SUCCESS){for(i=[],r=0;r<a.rows.length;r++)i.push({label:a.rows[r].basicValue,value:a.rows[r].basicId});e.repairTaskTypeData=i}else Object(l["c"])(a.message);t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(u["a"])(s["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,null,[[0,7,10,12]])})))()},getExtend18Data:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(f["c"])({basicInformationEnum:"REPAIR_TASK_IS_DOWN"});case 3:if(a=t.sent,a.code===s["M"].OPERATION_SUCCESS){for(i=[],r=0;r<a.rows.length;r++)i.push({label:a.rows[r].basicValue,value:a.rows[r].basicId});e.extend18Data=i}else Object(l["c"])(a.message);t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(u["a"])(s["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,null,[[0,7,10,12]])})))()}},watch:{requiredData:function(e,t){this.requiredData&&this.initData(),this.showDialog&&(this.showModalFlag=!0)},showDialog:function(e,t){this.showDialog||(this.showModalFlag=!1)}},created:function(){this.getRepairTaskTypeData(),this.getExtend18Data()}},b=g,v=b,E=(a("042b"),a("2877")),I=Object(E["a"])(v,i,r,!1,null,"35984596",null);t["a"]=I.exports},"4ce3":function(e,t,a){},"558b":function(e){e.exports=JSON.parse('{"code":"0000","rows":{},"message":"新增成功"}')},5861:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"operation-item",on:{click:e.onOprationItem}},[a("div",{staticClass:"operation-icon"},[e._t("operation-icon")],2),a("div",{staticClass:"operation-span"},[e._t("operation-name")],2)])},r=[],n=(a("b0c0"),{props:{name:{type:String,required:!0}},methods:{onOprationItem:function(){this.$emit("onOprationItem",this.name)}}}),s=n,o=(a("01f6"),a("2877")),c=Object(o["a"])(s,i,r,!1,null,"0cfe45f8",null);t["a"]=c.exports},"5d7b":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"create-fix-task",attrs:{width:"70%",title:e.title,visible:e.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialog=t},closed:e.cancelAction}},[a("div",{staticClass:"content"},[e.showDialog?a("el-row",{staticClass:"type"},[a("el-col",{staticClass:"device-tree",attrs:{xs:6,sm:6,md:6,lg:6,xl:6}},[a("div",{staticClass:"type-select"},[a("el-button",{attrs:{type:1==e.typeSelect?"primary":""},on:{click:function(t){return e.switchTab("1")}}},[e._v(e._s(e.EQUIPMENT_DATA.GROUP_TYPE))]),a("el-button",{attrs:{type:2==e.typeSelect?"primary":""},on:{click:function(t){return e.switchTab("2")}}},[e._v(e._s(e.PAGE_TITLE.DEVICE_TYPE))])],1),a("ZTree",{staticStyle:{"overflow-y":"auto",height:"660px"},attrs:{isExpendAll:!0,nodes:e.nodeData},on:{ztreeOnClick:e.handleNodeClick}})],1),a("el-col",{attrs:{xs:18,sm:18,md:18,lg:18,xl:18}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{label:"设备名称"}},[a("el-input",{attrs:{placeholder:"设备名称"},model:{value:e.formInline.deviceName,callback:function(t){e.$set(e.formInline,"deviceName",t)},expression:"formInline.deviceName"}})],1),a("el-form-item",{attrs:{label:"设备编号"}},[a("el-input",{attrs:{placeholder:"设备编号"},model:{value:e.formInline.deviceCode,callback:function(t){e.$set(e.formInline,"deviceCode",t)},expression:"formInline.deviceCode"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getDeviceListByTree}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.resetSearch}},[e._v("重置")])],1)],1),a("vxe-table",{ref:"deviceListTable",staticClass:"device-table",attrs:{border:"","show-header-overflow":"","show-overflow":"","max-height":"288","highlight-hover-row":"",stripe:"","radio-config":{highlight:!0},"highlight-current-row":"",data:e.deviceListTable.data},on:{"radio-change":e.radioChangeEvent}},[a("vxe-table-column",{attrs:{type:"radio",width:"60"}}),a("vxe-table-column",{attrs:{field:"deviceName",title:e.ENERGY.DEVICENAME}}),a("vxe-table-column",{attrs:{field:"devicePriCode",title:e.ENERGY.DEVICECODE}}),a("vxe-table-column",{attrs:{field:"typeName",title:e.PAGE_TITLE.DEVICE_TYPE}})],1),a("vxe-pager",{staticClass:"eq-pagination",attrs:{perfect:"","current-page":e.deviceListTable.page.currentPage,"page-size":e.deviceListTable.page.pageSize,total:e.deviceListTable.page.total,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.deviceListTable.page,"currentPage",t)},"update:current-page":function(t){return e.$set(e.deviceListTable.page,"currentPage",t)},"update:pageSize":function(t){return e.$set(e.deviceListTable.page,"pageSize",t)},"update:page-size":function(t){return e.$set(e.deviceListTable.page,"pageSize",t)},"page-change":e.handleDeviceListTablePageChange}}),a("el-form",{ref:"form",attrs:{model:e.form,rules:e.confirmRules,"label-width":"120px"}},[a("el-form-item",{class:"requiredStar",attrs:{label:e.EQUIPMENT_DATA.REPAIR_TYPE}},[a("el-select",{attrs:{multiple:"",disabled:!e.hasValue(e.form.deviceCode),loading:e.repairTypeloading,prop:"repairType",placeholder:e.MSG.PLEASE_CHOOSE},model:{value:e.form.repairType,callback:function(t){e.$set(e.form,"repairType",t)},expression:"form.repairType"}},e._l(e.$store.state.filters.repairTypeData,(function(e){return a("el-option",{key:e.repairName,attrs:{label:e.repairName,value:e.repairTypeId}})})),1)],1),a("el-form-item",{attrs:{label:"维修类别"}},[a("el-select",{attrs:{placeholder:e.MSG.PLEASE_CHOOSE},model:{value:e.form.repairTaskType,callback:function(t){e.$set(e.form,"repairTaskType",t)},expression:"form.repairTaskType"}},e._l(e.repairTaskTypeData,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"是否停机"}},[a("el-select",{attrs:{placeholder:e.MSG.PLEASE_CHOOSE},model:{value:e.form.extend18,callback:function(t){e.$set(e.form,"extend18",t)},expression:"form.extend18"}},e._l(e.extend18Data,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"故障描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.warrantyDescription,callback:function(t){e.$set(e.form,"warrantyDescription",t)},expression:"form.warrantyDescription"}})],1),a("el-form-item",{attrs:{label:e.REPAIR_TASK.ADD_PIC}},[a("div",{staticClass:"uploadDiv"},[a("el-upload",{ref:"upload",attrs:{"list-type":"picture-card",accept:".JPG, .PNG, .JPEG,.jpg, .png, .jpeg",disabled:e.isCanUpload,headers:e.uploadConfig.headers,action:e.uploadConfig.url,data:e.uploadConfig.data,"before-upload":e.updateFiles,"file-list":e.fileList,"on-success":e.updateSuccess,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[a("i",{staticClass:"el-icon-plus"})])],1)]),e.extendPropertyValueVoList&&e.extendPropertyValueVoList.length>0?a("el-row",{attrs:{gutter:24}},e._l(e.extendPropertyValueVoList,(function(t,i){return a("el-col",{key:i,attrs:{span:24}},[a("el-form-item",{class:{requiredStar:1===t.propertyIsNull},attrs:{label:t.extendName,prop:"extendPropertyValueVoList."+i+".extendValue",rules:e.confirmRules[t.propertyCode]}},[3!==t.propertyType?a("el-input",{on:{input:function(t){return e.change(t)}},model:{value:t.extendValue,callback:function(a){e.$set(t,"extendValue",a)},expression:"item.extendValue"}}):a("el-date-picker",{attrs:{type:"datetime",format:e.FORM_CONFIG_DATE[t.propertyLength],"value-format":e.FORM_CONFIG_DATE[t.propertyLength]},on:{input:function(a){return e.datetimeChange(t,a)}},model:{value:t.extendValue,callback:function(a){e.$set(t,"extendValue",a)},expression:"item.extendValue"}})],1)],1)})),1):e._e()],1)],1)],1):e._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",disabled:!e.checkDataFilled()},on:{click:e.confirmAction}},[e._v(e._s(e.confirmLabel))]),a("el-button",{attrs:{type:"tertiary"},on:{click:e.cancelAction}},[e._v(e._s(e.cancelLabel))])],1)])},r=[],n=(a("caad"),a("d81d"),a("b0c0"),a("ac1f"),a("5319"),a("96cf"),a("1da1")),s=a("582a"),o=a("786f"),c=a("f564"),l=a("e072"),u=a("b58d"),d=a("6f32"),p=a("3fa5"),h=a("6464"),f={components:{ZTree:d["a"]},name:"CreateNewFixTaskModal",props:{title:{type:String,default:""},cancelLabel:{type:String,default:s["c"].CANCEL},confirmLabel:{type:String,default:s["c"].CONFIRM_CREATE},showDialog:{type:Boolean,default:!1},isCanUpload:{type:Boolean,default:!1},handleCancel:Function,handleConfirm:Function,handleClose:Function,handleShowImg:Function},data:function(){var e=this,t=function(t,a,i){return e.$options.filters.formatterFormValidate(t,a,i,e.extendPropertyValueVoList)};return{setValidateForm:t,REPAIR_TASK:s["L"],FORM_CONFIG_DATE:s["D"],PAGE_TITLE:s["I"],ENERGY:s["q"],EQUIPMENT_DATA:s["s"],CONSTANTS_DEVICE_CONFIGURATION:s["i"],EQUIPMENT_LIVE:s["t"],MSG:s["H"],createData:{},deviceNMloading:!1,repairTypeloading:!1,typeSelect:"1",selectDeviceFilter:[],nodeData:[],selectRow:null,deviceListTable:{page:{currentPage:1,pageSize:10,total:30,pageSizes:[5,10,20,50,100,200,500],perfect:!0,layouts:["Sizes","PrevJump","PrevPage","Number","NextPage","NextJump","FullJump","Total"]},columns:[{field:"deviceName",title:s["q"].DEVICENAME,align:"center"},{field:"devicePriCode",title:s["q"].DEVICECODE,align:"center"},{field:"mode",title:s["q"].DEVICETYPECODE,align:"center"},{field:"typeName",title:s["I"].DEVICE_TYPE,align:"center"},{field:"groupName",title:s["q"].GROUPNAME,align:"center"}],data:[]},extendPropertyValueVoList:[],confirmRules:{},relationshipId:"",dialogImageUrl:"",fileList:[],delFileList:[],dialogVisible:!1,uploadConfig:{headers:{token:window.localStorage.getItem("token").replace(/"/g,"")},url:s["E"].PUBLICIP+"fileResource/uploadOneFile.action",data:{fileResourceTypeEnum:s["z"].REPAIR_DESCRIPTION_IMAGE,relationshipId:""}},form:{deviceCode:"",repairType:null,extend18:null,repairTaskType:null,warrantyDescription:"",extendPropertyValueVoList:[]},formInline:{deviceName:"",deviceCode:""},repairTaskTypeData:[],extend18Data:[]}},methods:{resetSearch:function(){this.formInline.deviceName="",this.formInline.deviceCode="",this.getDeviceListByTree()},initPage:function(){this.getTreeBydeviceGroup(),this.getDeviceListByTree()},getRepairTaskTypeData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["c"])({basicInformationEnum:"REPAIR_TASK_TYPE"});case 3:if(a=t.sent,a.code===s["M"].OPERATION_SUCCESS){for(i=[],r=0;r<a.rows.length;r++)i.push({label:a.rows[r].basicValue,value:a.rows[r].basicId});e.repairTaskTypeData=i}else Object(p["c"])(a.message);t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(h["a"])(s["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,null,[[0,7,10,12]])})))()},getExtend18Data:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["c"])({basicInformationEnum:"REPAIR_TASK_IS_DOWN"});case 3:if(a=t.sent,a.code===s["M"].OPERATION_SUCCESS){for(i=[],r=0;r<a.rows.length;r++)i.push({label:a.rows[r].basicValue,value:a.rows[r].basicId});e.extend18Data=i}else Object(p["c"])(a.message);t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(h["a"])(s["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,null,[[0,7,10,12]])})))()},getTreeBydeviceGroup:function(){var e=this;Object(l["R"])().then((function(t){if(t.code===s["M"].OPERATION_SUCCESS){e.nodeData=t.rows;for(var a=0;a<e.nodeData.length;a++)if(e.nodeData[a].code){e.selectData=e.nodeData[a];break}}else Object(p["c"])(t.message)})).catch((function(e){Object(h["a"])(e)}))},getTreeBydeviceWorkshopType:function(){var e=this;Object(l["tb"])().then((function(t){if(t.code===s["M"].OPERATION_SUCCESS){e.nodeData=t.rows;for(var a=0;a<e.nodeData.length;a++)if(e.nodeData[a].code){e.selectData=e.nodeData[a];break}}else Object(p["c"])(t.message)})).catch((function(e){Object(h["a"])(e)}))},getDeviceListByTree:function(){var e=this,t={current:this.deviceListTable.page.currentPage,size:this.deviceListTable.page.pageSize};"1"===this.typeSelect&&(t.groupIdList=this.selectDeviceFilter),"2"===this.typeSelect&&(t.typeIdList=this.selectDeviceFilter),t.deviceName=this.formInline.deviceName,Object(l["Z"])(t).then((function(t){t.code===s["M"].OPERATION_SUCCESS?(e.deviceListTable.data=t.rows,e.deviceListTable.page.total=t.total):Object(p["c"])(t.message)})).catch((function(e){Object(h["a"])(e)}))},switchTab:function(e){this.typeSelect=e,"1"===e?this.getTreeBydeviceGroup():this.getTreeBydeviceWorkshopType()},handleDeviceListTablePageChange:function(e){this.deviceListTable.page.currentPage=e.currentPage,this.deviceListTable.page.pageSize=e.pageSize,this.getDeviceListByTree()},radioChangeEvent:function(e){this.selectRow=e.row,this.form.deviceCode=this.selectRow.deviceCode,this.form.repairType=null,this.getRepairNameData()},handleNodeClick:function(e,t,a){this.selectData=t.name,this.selectDeviceFilter=[],this.selectDeviceFilter=this.getChildren(this.selectDeviceFilter,t),this.deviceListTable.page.currentPage=1,this.getDeviceListByTree(),this.clearData()},getChildren:function(e,t){if(e.push(t.id),t.isParent)for(var a in t.children)this.getChildren(e,t.children[a]);return e},checkDataFilled:function(){var e=!1;return this.form.repairType&&(e=!0),e},cancelAction:function(){this.handleCancel&&this.handleCancel()},confirmAction:function(){var e=this;this.$refs.form.validate((function(t){t&&e.saveTask()}))},saveTask:function(){var e=this,t=this.fileList.map((function(e){var t="";return t=e.flag?e.id:e.response.rows.resourceId,t})),a={deviceCode:this.form.deviceCode,repairTypeIdList:this.form.repairType,warrantyDescription:this.form.warrantyDescription};this.form.extend18&&(a.extend18=this.form.extend18),this.form.repairTaskType&&(a.repairTaskType=this.form.repairTaskType),Object(c["Z"])(a).then((function(a){a.code===s["M"].OPERATION_SUCCESS?(t.length>0&&e.saveRepairImg(a.rows.repairTaskId,t),e.extendPropertyValueVoList.length>0&&e.saveExtendValue(a.rows.repairTaskId,e.extendPropertyValueVoList),0!==e.delFileList.length&&e.delImg(),Object(p["b"])(a.message),setTimeout((function(){e.handleConfirm(),e.clearData()}),300)):Object(p["c"])(a.message)})).catch((function(e){Object(h["a"])(e)}))},saveRepairImg:function(e,t){for(var a=[],i=0;i<t.length;i++){var r={relationshipId:e,resourceId:t[i]};a.push(r)}Object(c["n"])({},a).then((function(e){e.code===s["M"].OPERATION_SUCCESS||Object(p["c"])(e.message)})).catch((function(e){Object(h["a"])(e)}))},closeAction:function(){this.handleClose&&(this.clearData(),this.handleClose())},hasValue:function(e){var t=!1;return e&&""!==e&&(t=!0),t},getRepairNameData:function(){var e=this;this.createData.repairType=null,this.repairTypeloading=!0,Object(c["mb"])({deviceCode:this.form.deviceCode}).then((function(t){if(t.code===e.GLOBAL.STATUS_CODE.OPERATION_SUCCESS){var a={name:"repairTypeData",data:t.rows};e.repairTypeloading=!1,e.$store.commit("setFiltersData",a)}}))},clearData:function(){this.selectRow=null,this.createData={repairType:null,deviceCode:null},this.extendPropertyValueVoList=[],this.confirmRules={},this.fileList=[],this.delFileList=[],this.form={deviceCode:"",repairType:null,warrantyDescription:"",extendPropertyValueVoList:[]}},handleRemove:function(e,t){e.flag?(this.delFileList.push(e.id),this.fileList=t):(this.delFileList.push(e.response.rows.resourceId),this.fileList=t)},updateSuccess:function(e,t,a){this.fileList.push(t),e.code,this.GLOBAL.STATUS_CODE.OPERATION_SUCCESS},delImg:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(u["A"])({ids:e.delFileList},[]);case 3:a=t.sent,a.code===s["M"].OPERATION_SUCCESS?e.delFileList=[]:Object(p["c"])(a.message),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(h["a"])(s["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,null,[[0,7,10,12]])})))()},handlePictureCardPreview:function(e){this.handleShowImg(e.url)},updateFiles:function(e){var t=["image/JPG","image/PNG","image/JPEG","image/jpeg","image/jpg","image/png"],a=t.includes(e.type);if(!a)return this.$message.error("上传图片只能是 JPG、JPEG、PNG 格式!"),!1;var i=e.size/1024/1024<5;return i?void 0:(this.$message.error("上传图片大小不能超过 5MB!"),!1)},setTableColumn:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(o["a"])({},{conditionJson1:[{column:"extendType",conditionJson1:[],conditionJson2:[],current:0,operator:1,operatorGroup:0,orderBy:{},ptype:"int",size:0,type:"eq",value:6}]});case 3:a=t.sent,a.code===s["M"].OPERATION_SUCCESS?(e.extendPropertyValueVoList=a.rows,i={},i.extendPropertyValueVoList=a.rows,e.toExtendRulesAndShow(i)):Object(p["c"])(a.message),t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:return t.prev=9,t.finish(9);case 11:case"end":return t.stop()}}),t,null,[[0,7,9,11]])})))()},saveExtendValue:function(e,t){var a=t.map((function(t){var a={};return a.extendId=t.extendId,a.relationshipTypeId=e,a.propertyCode=t.propertyCode,null===t.extendValue?a.extendValue="":a.extendValue=t.extendValue,a}));Object(o["b"])({},a).then((function(e){e.code===s["M"].OPERATION_SUCCESS||Object(p["c"])(e.message)})).catch((function(e){Object(h["a"])(e)}))},toExtendRulesAndShow:function(e){var t=e.extendPropertyValueVoList.map((function(e){return e.extendValue=e.extendValue?e.extendValue:null,e}));this.extendPropertyValueVoList=t;var a=JSON.parse(JSON.stringify(this.confirmRules));for(var i in this.extendPropertyValueVoList)3===this.extendPropertyValueVoList[i].propertyType?a[this.extendPropertyValueVoList[i].propertyCode]=[{validator:this.setValidateForm,trigger:["blur","change"]}]:a[this.extendPropertyValueVoList[i].propertyCode]=[{validator:this.setValidateForm,trigger:"blur"}];a.repairType=[[{required:!0,message:s["H"].PLEASE_ENTER_CONTENT}]],this.form.extendPropertyValueVoList=this.extendPropertyValueVoList,this.confirmRules=a},datetimeChange:function(e,t){var a=this;e.extendValue=t,a.$forceUpdate()},change:function(e){this.$forceUpdate()}},watch:{showDialog:function(e,t){e&&this.initPage()}},created:function(){this.clearData(),this.initPage(),this.setTableColumn(),this.getRepairTaskTypeData(),this.getExtend18Data()}},m=f,T=m,g=(a("6c2b"),a("2877")),b=Object(g["a"])(T,i,r,!1,null,"2900d1ff",null);t["a"]=b.exports},"6a2c":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a("4160"),a("b0c0"),a("159b");var i=a("558b"),r=a("a97e"),n=a("8ce4"),s=a("c1df"),o=a.n(s),c={addRepairTask:function(e){var t=i;return t},deleteRepairTask:function(e){var t=r;return t},getAllRepairTypeData:function(){var e=n;return e},generateFilters:function(e){var t={};for(var a in e)e[a]&&(t.hasFilter=!0,t[a]=e[a]);return t},generateFixTableData:function(e){return e.forEach((function(e){if(e.startTime&&e.endTime){var t=o()(e.startTime),a=o()(e.endTime);e.totalTime=a.diff(t,"seconds")}else e.totalTime=0;e.users=[],e.repairUserIdList&&("string"===typeof e.repairUserIdList?e.users.push(e.repairUserNameMap[e.repairUserIdList]):e.repairUserIdList.forEach((function(t){e.users.push(e.repairUserNameMap[t])})))})),e},generateFixTaskFileData:function(e){return e.forEach((function(e){e.name=e.fileName})),e},generateBatchUpdateRepairTypeData:function(e){var t=[];return e&&0!==e.length?(e.forEach((function(e){var a={downTime:e.downTime?parseInt(e.downTime):null,repairName:e.repairName?e.repairName:null,repairTypeId:e.repairTypeId?e.repairTypeId:null,state:e.state?e.state:null,typeIdList:e.typeIdList?e.typeIdList:[],typeNameList:e.typeNameList?e.typeNameList:[]};t.push(a)})),t):[]}}},"6c2b":function(e,t,a){"use strict";var i=a("c7b6"),r=a.n(i);r.a},"848c":function(e,t,a){"use strict";var i=a("f06d"),r=a.n(i);r.a},8954:function(e,t,a){"use strict";var i=a("0063"),r=a.n(i);r.a},"8ce4":function(e){e.exports=JSON.parse('{"code":"0000","rows":{"data":[{"repairTypeId":"1","repairName":"故障故障名称1","downTime":"状态","typeIdList":"设备类型id","typeNameList":"设备类型"},{"repairTypeId":"2","repairName":"机床故障","downTime":"停机","typeIdList":[1,2],"typeNameList":["机床1","机床2"]},{"repairTypeId":"3","repairName":"其他故障","downTime":"运行中","typeIdList":[1,2],"typeNameList":["机床3","机床4"]}]}}')},"9b33":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Div",{staticClass:"main"},[a("div",{staticClass:"searchDiv"},[a("span",[e._v("时间段：")]),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",size:"mini"},model:{value:e.lineTime,callback:function(t){e.lineTime=t},expression:"lineTime"}}),a("el-button",{attrs:{size:"mini"},on:{click:e.search}},[e._v(e._s(e.BTN_TEXT.SEARCH))])],1),a("div",[a("p",{staticClass:"tittle"},[e._v("设备参数")]),a("div",{staticClass:"selectDiv"},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.relationshipId,callback:function(t){e.relationshipId=t},expression:"relationshipId"}},e._l(e.relationshipData,(function(t,i){return a("el-radio",{key:i,attrs:{label:i,border:""}},[e._v(e._s(t.parameterName))])})),1)],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showFlag,expression:"showFlag"}],attrs:{id:"showEcharts"}})])},r=[],n=(a("a9e3"),a("85a8")),s=a("5861"),o=a("582a"),c=a("f564"),l=a("3fa5"),u=a("6464"),d=a("eec9"),p={components:{HeaderTitle:n["a"],HeadOperationItem:s["a"],SearchBox:d["a"]},props:{selectdata:{type:Object,default:function(){}},showBack:{type:Boolean,default:!1},handleBack:Function},data:function(){var e=this;return{PAGE_TITLE:o["I"],BTN_TEXT:o["c"],EQUIPMENT_DATA:o["s"],ENERGY:o["q"],tableLoading:!1,searchList:[],relationshipId:null,relationshipData:[],showFlag:!0,lineTime:[],timeOptionRange:"",pickerOptions:{onPick:function(t){t.minDate&&!t.maxDate&&(e.timeOptionRange=t.minDate),t.maxDate&&(e.timeOptionRange=null)},disabledDate:function(t){var a=e.timeOptionRange,i=6048e5;return a?a.getTime()+i>Date.now()-864e4?t.getTime()>Date.now()-864e4||t.getTime()<a.getTime()-i:t.getTime()>a.getTime()+i||t.getTime()<a.getTime()-i:t.getTime()>Date.now()}}}},watch:{relationshipId:function(e){console.log(e),e>=0?(this.showFlag=!0,this.showEchart(e)):(this.showFlag=!0,this.showEchartsData([],[]))}},methods:{showEchart:function(e){for(var t=[],a=[],i=[],r=this.relationshipData[e].parameterRecordList,n=0;n<r.length;n++)t.push(r[n].time),a.push(Number(r[n].value));i.push({name:this.relationshipData[e].parameterName,type:"line",data:a}),this.showEchartsData(i,t)},showEchartsData:function(e,t){var a=this.$echarts.init(document.getElementById("showEcharts"));a.setOption({title:{text:"参数折线图"},tooltip:{trigger:"axis"},toolbox:{},dataZoom:[{show:!0,realtime:!0,start:0,end:100},{type:"inside",realtime:!0,start:0,end:100}],grid:{left:"4%",right:"5%",bottom:"10%",containLabel:!0},xAxis:{type:"category",name:"时间",boundaryGap:!1,data:t},yAxis:{type:"value",name:"参数值"},series:e},!0)},search:function(){this.showEchartsData([],[]),this.relationshipData=[],this.relationshipId=null,this.initData()},initData:function(){var e=this,t={startTime:this.lineTime[0],endTime:this.lineTime[1],deviceCode:this.selectdata.deviceCode};Object(c["l"])(t,{}).then((function(t){t.code===o["M"].OPERATION_SUCCESS?e.relationshipData=t.rows:Object(l["c"])(t.message)})).catch((function(e){Object(u["a"])(e)}))},goBack:function(){this.handleBack()},formatDateTime:function(e){var t="",a="";t=void 0!==e?new Date(e):new Date;var i=t.getFullYear(),r=t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getDate()<10?"0"+t.getDate():t.getDate(),s=t.getHours()<10?"0"+t.getHours():t.getHours(),o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),c=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return a=i+"-"+r+"-"+n+" "+s+":"+o+":"+c,a}},created:function(){this.lineTime=[this.selectdata.createTime],this.selectdata.endTime?this.lineTime.push(this.selectdata.endTime):this.lineTime.push(this.formatDateTime(new Date(this.selectdata.createTime).getTime()+864e5)),this.initData()}},h=p,f=h,m=(a("8954"),a("2877")),T=Object(m["a"])(f,i,r,!1,null,"75e25cb8",null);t["a"]=T.exports},a97e:function(e){e.exports=JSON.parse('{"code":"0000","rows":{},"message":"删除成功"}')},b58d:function(e,t,a){"use strict";a.d(t,"l",(function(){return n})),a.d(t,"m",(function(){return s})),a.d(t,"n",(function(){return o})),a.d(t,"o",(function(){return c})),a.d(t,"p",(function(){return l})),a.d(t,"k",(function(){return u})),a.d(t,"H",(function(){return d})),a.d(t,"G",(function(){return p})),a.d(t,"I",(function(){return h})),a.d(t,"s",(function(){return f})),a.d(t,"t",(function(){return m})),a.d(t,"u",(function(){return T})),a.d(t,"r",(function(){return g})),a.d(t,"i",(function(){return b})),a.d(t,"j",(function(){return v})),a.d(t,"h",(function(){return E})),a.d(t,"v",(function(){return I})),a.d(t,"w",(function(){return C})),a.d(t,"e",(function(){return O})),a.d(t,"d",(function(){return k})),a.d(t,"b",(function(){return D})),a.d(t,"f",(function(){return y})),a.d(t,"y",(function(){return R})),a.d(t,"c",(function(){return x})),a.d(t,"g",(function(){return w})),a.d(t,"a",(function(){return P})),a.d(t,"z",(function(){return N})),a.d(t,"A",(function(){return S})),a.d(t,"B",(function(){return _})),a.d(t,"F",(function(){return L})),a.d(t,"q",(function(){return A})),a.d(t,"x",(function(){return F})),a.d(t,"E",(function(){return j})),a.d(t,"C",(function(){return M})),a.d(t,"D",(function(){return V}));var i=a("b775"),r=a("99f6"),n=function(e,t){return Object(i["k"])("checkItems/getAll.action?",e,t)},s=function(e,t){return Object(i["k"])("checkItems/getList.action?",e,t)},o=function(e,t){return Object(i["k"])("checkItems/insert.action?",e,t)},c=function(e,t){return Object(i["k"])("checkItems/insertBatch.action?",e,t)},l=function(e,t){return Object(i["k"])("checkItems/updateById.action?",e,t)},u=function(e,t){return Object(i["k"])("checkItems/deleteByIds.action?",e,t)},d=function(e,t){return Object(i["k"])("scenes/getPageScenes.action?",e,t)},p=function(e,t){return Object(i["k"])("scenes/deleteByIds.action?",e,t)},h=function(e,t){return Object(i["k"])("scenes/insertOrUpdateScenesAndShift.action?",e,t)},f=function(e,t){return Object(i["k"])("checkTemplate/getPageCheckTemplate.action?",e,t)},m=function(e,t){return Object(i["k"])("checkTemplate/insert.action?",e,t)},T=function(e,t){return Object(i["k"])("checkTemplate/updateById.action?",e,t)},g=function(e,t){return Object(i["k"])("checkTemplate/deleteByIds.action?",e,t)},b=function(e,t){return Object(i["k"])("checkItemTemplateRelationship/getListCheckTemplateRelationshipItem.action?",e,t)},v=function(e,t){return Object(i["k"])("checkItemTemplateRelationship/insertOrUpdateBatch.action?",e,t)},E=function(e,t){return Object(i["k"])("checkItemTemplateRelationship/deleteById.action?",e,t)},I=function(e,t){return Object(i["k"])("checkTemplateWorkshopTypeRelationship/getPageWorkshopTypeRelationshipTemplate.action?",e,t)},C=function(e,t){return Object(i["k"])("checkTemplateWorkshopTypeRelationship/updateWorkshopTypeRelationshipTemplate.action?",e,t)},O=function(e,t){return Object(i["k"])("check/getListGroupTreeDeviceCheckByCurrentUser.action?",e,t)},k=function(e,t){return Object(i["k"])("check/getListGroupTreeDeviceCheck.action?",e,t)},D=function(e,t){return Object(i["k"])("check/getListCheckListByDeviceCode.action?",e,t)},y=function(e,t){return Object(i["k"])("check/getListLastCheckListByDeviceCode.action?",e,t)},R=function(e,t){return Object(i["k"])("check/updateCheckList.action?",e,t)},x=function(e,t){return Object(i["k"])("check/getListDeviceCheckHistory.action?",e,t)},w=function(e,t){return Object(i["k"])("check/getListShiftByDeviceCode.action?",e,t)},P=function(e,t){return Object(i["k"])("check/getAppCheckListByDateAndDeviceCode.action?",e,t)},N=function(e,t){return Object(i["k"])("check/updateHolidayInspectionFree.action?",e,t)},S=function(e,t){return Object(i["k"])("fileResource/deleteByIds.action?",e,t)},_=function(e,t){return Object(i["k"])("check/getCheckRepairTaskSwitch.action?",e,t)},L=function(e,t){return Object(i["k"])("check/insertCheckRepairTask.action?",e,t)},A=function(e,t){return Object(i["k"])("check/checkReview.action?",e,t)},F=function(e,t){return Object(i["k"])("check/checkUnReview.action?",e,t)},j=function(e,t){return Object(i["k"])("check/getUnReviewCheckRecord.action?",e,t)},M=function(e,t){return Object(i["e"])(r["d"]+"check/getListCheckListByDeviceCode.action?",e,t)},V=function(e,t){return Object(i["e"])(r["d"]+"check/getListLastCheckListByDeviceCode.action?",e,t)}},c52c:function(e,t,a){},c7b6:function(e,t,a){},da38:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("sHeader",{attrs:{titleName:e.WORK_STATION.EQUIPMENT_FIXING}},[a("div",{staticClass:"head-operation",attrs:{slot:"header-action"},slot:"header-action"},[a("HeaderAction",{attrs:{name:"1"},on:{onOprationItem:function(t){return e.goHome()}}},[a("el-button",{attrs:{slot:"action"},slot:"action"},[a("i",{staticClass:"el-icon-d-arrow-left"}),e._v(e._s(e.BTN_TEXT.RETURN)+" ")])],1),a("HeaderAction",{attrs:{name:"1"},on:{onOprationItem:function(t){return e.showCreateFixTaskModal()}}},[a("el-button",{attrs:{slot:"action"},slot:"action"},[a("i",{staticClass:"el-icon-plus"}),e._v(e._s(e.BTN_TEXT.CREATE_FIXTASK)+" ")])],1)],1)]),a("el-container",{staticClass:"station-fixtask"},[e.equipmentPicPage.show?e._e():a("el-col",{staticClass:"sm-right",attrs:{span:24}},[a("div",{staticClass:"searchTask"},[a("div",{staticClass:"searchDiv"},[a("el-label",[e._v("车间分组：")]),a("el-cascader",{staticClass:"formItem_full",attrs:{clearable:"",size:"mini",options:e.groupOptions,props:{expandTrigger:"hover"},"show-all-levels":!0},model:{value:e.formInline.groupId,callback:function(t){e.$set(e.formInline,"groupId",t)},expression:"formInline.groupId"}})],1),a("div",{staticClass:"searchDiv"},[a("el-label",[e._v("设备类型：")]),a("el-cascader",{staticClass:"formItem_full",attrs:{clearable:"",size:"mini",options:e.typeOptions,props:{checkStrictly:!0},"show-all-levels":!1},model:{value:e.formInline.typeId,callback:function(t){e.$set(e.formInline,"typeId",t)},expression:"formInline.typeId"}})],1),a("div",{staticClass:"searchDiv"},[a("el-label",[e._v("设备名称：")]),a("el-input",{attrs:{clearable:"",size:"mini"},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}})],1),a("div",{staticClass:"searchDiv"},[a("el-label",[e._v("故障类型：")]),a("el-select",{attrs:{size:"mini",clearable:"",placeholder:e.MSG.PLEASE_CHOOSE},model:{value:e.repairTypeIdList,callback:function(t){e.repairTypeIdList=t},expression:"repairTypeIdList"}},e._l(e.repairTypeData,(function(e){return a("el-option",{key:e.repairName,attrs:{label:e.repairName,value:e.repairTypeId}})})),1)],1),a("div",{staticClass:"searchDiv"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.getFixTableData}},[e._v(e._s(e.BTN_TEXT.SEARCH))]),a("el-button",{attrs:{size:"mini"},on:{click:e.reset}},[e._v(e._s(e.BTN_TEXT.RESET))])],1)]),a("div",{attrs:{id:"tabs"}},[a("ul",{staticClass:"selectInfo"},e._l(e.tab,(function(t,i){return a("li",{key:i,class:{active:e.active2==t.value},on:{click:function(a){return e.toggle2(t.value,t.views)}}},[e._v(e._s(t.name))])})),0)]),a("div",{staticStyle:{clear:"both"}},[a("VXETable",{ref:"FixGrid",attrs:{tableName:e.EQUIPMENT_DATA.FIXTASK_TABLE,height:e.$options.filters.getTableHeight(160),tableLoading:e.tableLoading,"pager-config":e.fixTableData.page,tableDatas:e.fixTableData.data,tableColumns:e.fixTableData.columns,tablePage:e.fixTableData.page},on:{onTablePageChange:e.handleFixTablePageChange}})],1)]),e.equipmentPicPage.show?a("el-col",{attrs:{span:24}},[a("equipment-pic",{attrs:{selectdata:e.equipmentPicPagedata,showBack:!0,handleBack:e.closeEquipment}})],1):e._e(),a("create-new-fix-task-modal",{ref:"createFixTask",attrs:{showDialog:e.createNewFixTaskModalData.show,title:e.createNewFixTaskModalData.title,handleCancel:e.clickCancel,handleConfirm:e.createFixTask,handleClose:e.clickCancel,handleShowImg:e.showImg,objectId:"1"}}),a("fix-task-confirm-task-modal",{ref:"fixTaskConfirm",attrs:{showDialog:e.fixTaskConfirmTaskModalData.show,title:e.fixTaskConfirmTaskModalData.title,handleCancel:e.clickCancel,handleConfirm:e.confirmTask,handleClose:e.clickCancel,readOnly:e.fixTaskConfirmTaskModalData.readonly,requiredData:e.fixTaskConfirmTaskModalData.data,dataset:e.fixTaskConfirmTaskModalData.dataset,tabs:e.tabs,active2:e.active2,handleShowImg:e.showImg,publicFun:e.repairDialogFun}}),a("el-dialog",{attrs:{visible:e.dialogVisible,title:e.VARIABLE.IMAGE},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1)},r=[],n=(a("99af"),a("a15b"),a("d81d"),a("fb6a"),a("ac1f"),a("5319"),a("96cf"),a("1da1")),s=a("85a8"),o=a("5861"),c=a("cf46"),l=a("9b33"),u=a("5d7b"),d=a("1647"),p=a("6a2c"),h=a("17cb"),f=a("3fa5"),m=a("6464"),T=a("1660"),g=a("ac6c"),b=a("f82c"),v=a("e072"),E=a("f564"),I=(a("87b4"),a("786f")),C=a("582a"),O={components:{HeaderTitle:s["a"],HeadOperationItem:o["a"],VXETable:c["a"],equipmentPic:l["a"],CreateNewFixTaskModal:u["a"],FixTaskConfirmTaskModal:d["a"],sHeader:T["a"],HeaderAction:g["a"]},data:function(){var e=this,t=this.$createElement;return{REPAIR_TASK:C["L"],VARIABLE:C["P"],WORK_STATION:C["R"],FIXTASK_TYPE_STATUS:C["C"],TITLE:C["N"],PAGE_TITLE:C["I"],ENERGY:C["q"],MSG:C["H"],FIXTASK_STATUS:C["A"],EQUIPMENT_DATA:C["s"],BTN_TEXT:C["c"],fixTableData:{data:[],page:{total:0,currentPage:1,pageSize:10,pageSizes:[10,20,50,100,200,500],perfect:!0,layouts:["Sizes","PrevJump","PrevPage","Number","NextPage","NextJump","FullJump","Total"]},columns:[{field:"repairCode",width:"160",title:C["q"].REPAIR_CODE,align:"center"},{field:"factory",width:"160",title:C["q"].FACTORY,align:"center"},{field:"workshop",width:"160",title:C["q"].WORKSHOP,align:"center"},{field:"productionLine",width:"160",title:C["q"].PRODUCTION_LINE,align:"center"},{field:"deviceName",width:"160",title:C["q"].DEVICENAME,align:"center"},{field:"devicePriCode",width:"160",title:C["q"].DEVICECODE,align:"center"},{field:"repairTypeNameList",width:"160",title:C["s"].REPAIR_TYPENAMELIST,align:"center"},{field:"occurTime",width:"160",title:C["s"].OCCURTIME,align:"center"},{field:"startTime",width:"160",title:C["s"].REPAIR_STARTTIME,align:"center",formatter:function(e){var t=e.row;return t.startTime?t.startTime:""}},{field:"endTime",width:"160",title:C["s"].REPAIR_ENDTIME,align:"center"},{field:"totalTime",width:"160",title:C["s"].REPAIR_TOTALTIME,align:"center",formatter:this.$options.filters.formatDifferentTime},{field:"users",width:"160",title:C["s"].REPAIR_USER,align:"center"},{field:"repairState",width:"160",title:C["s"].STATUS,align:"center",slots:{default:function(e){var a=e.row;return[t("span",[C["A"][a.repairState]])]}},sortable:!0},{field:"",title:C["c"].OPERATION,width:"250",fixed:"right",align:"center",slots:{default:function(t){var a=t.row;t.column;return e.optionsBtn(a)}}}]},groupFilterData:null,repairTypeFilterData:null,deviceNameList:null,userNameList:null,filterData:{group:null,divice:null,repairType:null,user:null,repairtState:null},tableLoading:!1,title:"",selectRecords:[],defaultPageTitle:C["I"].REPAIR_TASK,createNewFixTaskModalData:{title:C["c"].CREATE_FIXTASK,show:!1},fixTaskConfirmTaskModalData:{title:C["s"].REPAIR_CONFIRM,show:!1,data:null,readonly:!1},fixManagementPage:{show:!1,title:C["s"].REPAIR_MANAGEMENT_TYPE,data:null,renderData:null,deleteList:[]},equipmentPicPage:{show:!1,title:C["c"].EQUIPMENT_PIC,data:null},equipmentPicPagedata:null,active2:2,tab:[],dialogImageUrl:"",dialogVisible:!1,repairTaskId:0,isCanUpload:!0,typeOptions:[],typeOptionsY:[],groupOptions:[],groupOptionsY:[],formInline:{typeId:0,groupId:0},repairTypeIdList:[],repairTypeData:[],searchName:"",tabs:[0,0,0,0,0]}},methods:{optionsBtn:function(e){var t=this,a=this.$createElement,i=a("el-button",{on:{click:function(){return t.acceptTask(e)}},attrs:{type:"text"}},[C["c"].ACCEPT_TASK]),r=a("el-button",{on:{click:function(){return t.showEquipmentPic(e)}},attrs:{type:"text"}},[C["c"].EQUIPMENT_PIC]),n=a("el-button",{on:{click:function(){return t.showConfirmFixModal(e)}},attrs:{type:"text"}},[C["c"].CONFIRM_REPAIR]),s=a("el-button",{on:{click:function(){return t.chargeback(e)}},attrs:{type:"text"}},[C["c"].CHARGE_BACK]),o=a("el-button",{on:{click:function(){return t.revoke(e)}},attrs:{type:"text"}},[C["c"].REVOKE]),c=a("el-button",{on:{click:function(){return t.showConfirmFixModal(e)}},attrs:{type:"text"}},[C["c"].INFO]),l=a("el-button",{on:{click:function(){return t.reject(e)}},attrs:{type:"text"}},[C["c"].REJECT]),u=a("el-button",{on:{click:function(){return t.repairPass(e)}},attrs:{type:"text"}},[C["c"].PASS]),d=[];switch(1===e.taskButton.isGrabMonad&&(1===this.tabs[0]?d.push(i):d.push(n)),1===e.taskButton.isChargeback&&d.push(o),1===e.taskButton.isRevoke&&d.push(s),1===e.taskButton.isReview&&d.push(u),1===e.taskButton.isReject&&d.push(l),this.active2){case 1:d.push(c);break;case 3:d.push(c);break;case 4:d.push(c);break;case 5:d.push(c);break}return d.push(r),d},repairDialogFun:function(e){var t={repairTaskId:this.repairTaskId};switch(e){case 1:this.acceptTask(t);break;case 2:this.chargeback(t);break;case 3:this.revoke(t);break;case 4:this.repairPass(t);break;case 5:this.reject(t);break}},reject:function(e){var t=this;this.$prompt(C["L"].PLEASE_INPUT_REJECT,C["N"].PROMPT,{confirmButtonText:C["c"].CONFIRM,cancelButtonText:C["c"].CANCEL}).then((function(a){var i=a.value;t.doReject(e.repairTaskId,i)})).catch((function(){}))},doReject:function(e,t){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function i(){var r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Object(E["T"])({repairTaskId:e,repairReason:t});case 3:r=i.sent,r.code===C["M"].OPERATION_SUCCESS?(Object(f["b"])(r.message),a.currentChangeRow={},a.getFixTableData()):Object(f["c"])(r.message),i.next=10;break;case 7:i.prev=7,i.t0=i["catch"](0),Object(m["a"])(C["N"].NOTIFY,i.t0);case 10:return i.prev=10,i.finish(10);case 12:case"end":return i.stop()}}),i,null,[[0,7,10,12]])})))()},repairPass:function(e){var t=this;this.$confirm(C["s"].PASS_THE_ORDER,C["N"].PROMPT,{confirmButtonText:C["c"].CONFIRM,cancelButtonText:C["c"].CANCEL,type:"warning"}).then((function(){t.doRepairPass(e.repairTaskId)})).catch((function(){}))},doRepairPass:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(E["V"])({repairTaskId:e});case 3:i=a.sent,i.code===C["M"].OPERATION_SUCCESS?(Object(f["b"])(i.message),t.currentChangeRow={},t.getFixTableData()):Object(f["c"])(i.message),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),Object(m["a"])(C["N"].NOTIFY,a.t0);case 10:return a.prev=10,a.finish(10);case 12:case"end":return a.stop()}}),a,null,[[0,7,10,12]])})))()},revoke:function(e){var t=this;this.$confirm(C["s"].REVOKE_THE_ORDER,C["N"].PROMPT,{confirmButtonText:C["c"].CONFIRM,cancelButtonText:C["c"].CANCEL,type:"warning"}).then((function(){t.doRevoke(e.repairTaskId)})).catch((function(){}))},doRevoke:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(E["W"])({repairTaskId:e});case 3:i=a.sent,i.code===C["M"].OPERATION_SUCCESS?(Object(f["b"])(i.message),t.currentChangeRow={},t.getFixTableData()):Object(f["c"])(i.message),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),Object(m["a"])(C["N"].NOTIFY,a.t0);case 10:return a.prev=10,a.finish(10);case 12:case"end":return a.stop()}}),a,null,[[0,7,10,12]])})))()},chargeback:function(e){var t=this;this.$confirm(C["s"].CHARGEBACK_THE_ORDER,C["N"].PROMPT,{confirmButtonText:C["c"].CONFIRM,cancelButtonText:C["c"].CANCEL,type:"warning"}).then((function(){t.doChargeback(e.repairTaskId)})).catch((function(){}))},doChargeback:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(E["U"])({repairTaskId:e});case 3:i=a.sent,i.code===C["M"].OPERATION_SUCCESS?(Object(f["b"])(i.message),t.currentChangeRow={},t.getFixTableData()):Object(f["c"])(i.message),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),Object(m["a"])(C["N"].NOTIFY,a.t0);case 10:return a.prev=10,a.finish(10);case 12:case"end":return a.stop()}}),a,null,[[0,7,10,12]])})))()},acceptTask:function(e){var t=this;this.$confirm(C["s"].RECEIVE_THE_ORDER,C["N"].PROMPT,{confirmButtonText:C["c"].CONFIRM,cancelButtonText:C["c"].CANCEL,type:"warning"}).then((function(){t.doAcceptTask(e.repairTaskId)})).catch((function(){}))},doAcceptTask:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(E["Y"])({repairTaskId:e});case 3:i=a.sent,i.code===C["M"].OPERATION_SUCCESS?(Object(f["b"])(i.message),t.currentChangeRow={},t.getFixTableData()):Object(f["c"])(i.message),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),Object(m["a"])(C["N"].NOTIFY,a.t0);case 10:return a.prev=10,a.finish(10);case 12:case"end":return a.stop()}}),a,null,[[0,7,10,12]])})))()},initPage:function(){this.title=this.defaultPageTitle,this.getFixTableData(),h["a"].getGroup(),h["a"].getUsers(),h["a"].getRelatedDeviceType(),this.userNameList=h["a"].getUsers()},reset:function(){this.repairTypeIdList=null,this.searchName="",this.formInline.groupId=null,this.formInline.typeId=null,this.getFixTableData()},getFixTableData:function(){this.clickCancel(),this.tableLoading=!0;var e=this,t=null;this.fixTableData&&this.fixTableData.page&&(t={current:this.fixTableData.page.currentPage,size:this.fixTableData.page.pageSize});var a={condition:{}};a={conditionJson1:[]};var i=this.active2;4===this.active2&&(i=5),this.repairTypeIdList&&a.conditionJson1.push({column:"repairTypeId",operator:1,ptype:"list",type:"in",value:this.repairTypeIdList}),this.searchName&&a.conditionJson1.push({column:"deviceName",operator:1,ptype:"string",type:"like",value:this.searchName}),this.formInline.groupId&&this.formInline.groupId.length>0&&a.conditionJson1.push({column:"groupId",operator:1,ptype:"list",type:"in",value:this.formInline.groupId[this.formInline.groupId.length-1]}),this.formInline.typeId&&this.formInline.typeId.length>0&&a.conditionJson1.push({column:"typeId",operator:1,ptype:"list",type:"in",value:this.formInline.typeId[this.formInline.typeId.length-1]});var r=[];r.push(i),2===i&&0===this.tabs[0]&&r.push(1),2===i&&0===this.tabs[2]&&r.push(5),(2===i||1===i)&&(0===this.tabs[0]||0===this.tabs[2])||a.conditionJson1.push({column:"userId",operator:1,ptype:"list",type:"in",value:localStorage.getItem("userId")}),a.conditionJson1.push({column:"repairState",operator:1,ptype:"list",type:"in",value:r.join(",")}),4===this.active2&&a.conditionJson1.push({column:"isMyReview",type:"eq",value:1,operator:1,ptype:"int"}),Object(E["ib"])(t,a).then((function(t){t.code===C["M"].OPERATION_SUCCESS?(e.fixTableData.data=p["a"].generateFixTableData(t.rows),e.fixTableData.page.total=t.total,e.tableLoading=!1):Object(f["c"])(t.message)})).catch((function(e){Object(m["a"])(e)}))},confirmTask:function(){this.clickCancel(),this.getFixTableData()},showCreateFixTaskModal:function(){this.$refs.createFixTask.clearData(),this.$refs.createFixTask.initPage(),this.$refs.createFixTask.setTableColumn(),this.createNewFixTaskModalData.show=!0},createFixTask:function(e){this.clickCancel(),this.getFixTableData()},clickCancel:function(){this.fixTaskConfirmTaskModalData.show=!1,this.createNewFixTaskModalData.show=!1,this.fixTaskConfirmTaskModalData.data={}},handleFixTablePageChange:function(e,t){this.fixTableData.page.currentPage=e,this.fixTableData.page.pageSize=t,this.getFixTableData()},showConfirmFixModal:function(e,t){var a=this;this.repairTaskId=e.repairTaskId,this.$refs.fixTaskConfirm.clearData(),t?(this.fixTaskConfirmTaskModalData.title=C["s"].REPAIR_DETAIL,this.fixTaskConfirmTaskModalData.readonly=!0):(this.fixTaskConfirmTaskModalData.title=C["s"].REPAIR_CONFIRM,this.fixTaskConfirmTaskModalData.readonly=!1),Object(E["G"])({repairTaskId:e.repairTaskId}).then((function(e){if(e.code===C["M"].OPERATION_SUCCESS){var t=p["a"].generateFixTableData([e.rows]),i=t[0];i.confirmRepairType=i.repairTypeIdList?i.repairTypeIdList:[],i.startTime=i.startTime?i.startTime:null,i.endTime=i.endTime?i.endTime:null,i.occurTime=a.$options.filters.formatTime(i.occurTime),i.userIdList=i.repairUserIdList?i.repairUserIdList:[],i.reasonContent=i.reasonContent?i.reasonContent:null,a.fixTaskConfirmTaskModalData.data=i,a.fixTaskConfirmTaskModalData.dataset=e.dataset,a.fixTaskConfirmTaskModalData.show=!0}else Object(f["c"])(e.message)})).catch((function(e){Object(m["a"])(e)})),Object(E["mb"])({deviceCode:e.deviceCode}).then((function(e){if(e.code===a.GLOBAL.STATUS_CODE.OPERATION_SUCCESS){var t={name:"repairTypeData",data:e.rows};a.$store.commit("setFiltersData",t)}}))},getRepairTypeList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(E["lb"])(null,{condition:{}});case 3:a=t.sent,a.code===e.GLOBAL.STATUS_CODE.OPERATION_SUCCESS?e.repairTypeData=a.rows:Object(f["c"])(a.message),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(m["a"])(e.GLOBAL.TITLE.NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,null,[[0,7,10,12]])})))()},showEquipmentPic:function(e){this.equipmentPicPagedata=e,this.equipmentPicPage.show=!0,this.title=this.equipmentPicPage.title},closeEquipment:function(){this.equipmentPicPagedata=null,this.equipmentPicPage.show=!1,this.title=this.defaultPageTitle},goBack:function(e){"picture"===e.page&&this.closeEquipment()},goHome:function(){this.$router.replace("/workstation/home")},setTableColumn:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,i,r,n,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(I["a"])({},{conditionJson1:[{column:"extendType",conditionJson1:[],conditionJson2:[],current:0,operator:1,operatorGroup:0,orderBy:{},ptype:"int",size:0,type:"eq",value:6}]});case 3:if(a=t.sent,a.code===C["M"].OPERATION_SUCCESS){if(e.extendPropertyValueVoList=a.rows,i=[],r=e.fixTableData.columns.slice(0,e.fixTableData.columns.length-1),n=e.fixTableData.columns[e.fixTableData.columns.length-1],i=i.concat(r),e.extendPropertyValueVoList.length>0)for(s=e.extendPropertyValueVoList,o=0;o<s.length;o++)i.push({field:s[o].propertyCode,title:s[o].extendName,width:"160",align:"center",formatter:e.$options.filters.formatterExtendValue});i=i.concat(n),e.fixTableData.columns=i}else Object(f["c"])(a.message);t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(m["a"])(C["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,null,[[0,7,10,12]])})))()},saveExtendValue:function(e){var t=this,a=e.map((function(e){return null===e.extendValue&&(e.extendValue=""),e}));Object(I["b"])({},a).then((function(e){e.code===C["M"].OPERATION_SUCCESS?(t.getFixTableData(),Object(f["b"])(e.message)):Object(f["c"])(e.message)})).catch((function(e){Object(m["a"])(e)}))},showTab:function(){var e=this,t=[{type:"process",name:C["A"][1],value:1},{type:"Processed",name:C["A"][2],value:2},{type:"Processed",name:C["A"][5],value:5},{type:"Processed",name:C["A"][4],value:4},{type:"Processed",name:C["A"][3],value:3}],a=this;Object(E["E"])({configurationRelationTypeEnum:"REPAIR"},{}).then((function(i){if(i.code===C["M"].OPERATION_SUCCESS){var r=[];i.rows.grab&&(r.push(t[0]),e.active2=1,a.tabs[0]=1),r.push(t[1]),a.tabs[1]=1,i.rows.review&&(r.push(t[2]),a.tabs[2]=1),i.rows.myReview&&(r.push(t[3]),a.tabs[3]=1),r.push(t[4]),a.tabs[4]=1,a.tab=r}})).catch((function(e){Object(m["a"])(e)}))},toggle2:function(e,t){this.fixTableData.page.currentPage=1,this.active2=e,this.getFixTableData()},showImg:function(e){this.dialogImageUrl=e,this.dialogVisible=!0},tableHeightFunc:function(){return document.documentElement.clientHeight-180},getTypeTree:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(b["e"])();case 3:a=t.sent,a.code===C["M"].OPERATION_SUCCESS?e.typeOptions=a.rows:Object(f["c"])(a.message),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(m["a"])(C["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:return t.prev=12,t.next=15,Object(v["tb"])();case 15:i=t.sent,i.code===C["M"].OPERATION_SUCCESS?(e.typeOptionsY=i.rows,e.getGroupTree()):Object(f["c"])(i.message),t.next=22;break;case 19:t.prev=19,t.t1=t["catch"](12),Object(m["a"])(C["N"].NOTIFY,t.t1);case 22:return t.prev=22,t.finish(22);case 24:case"end":return t.stop()}}),t,null,[[0,7,10,12],[12,19,22,24]])})))()},getGroupTree:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(b["c"])();case 3:a=t.sent,a.code===C["M"].OPERATION_SUCCESS?e.groupOptions=a.rows:Object(f["c"])(a.message),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),Object(m["a"])(C["N"].NOTIFY,t.t0);case 10:return t.prev=10,t.finish(10);case 12:return t.prev=12,t.next=15,Object(v["R"])();case 15:i=t.sent,i.code===C["M"].OPERATION_SUCCESS?e.groupOptionsY=i.rows:Object(f["c"])(i.message),t.next=22;break;case 19:t.prev=19,t.t1=t["catch"](12),Object(m["a"])(C["N"].NOTIFY,t.t1);case 22:return t.prev=22,t.finish(22);case 24:case"end":return t.stop()}}),t,null,[[0,7,10,12],[12,19,22,24]])})))()}},mounted:function(){var e=this;this.showTab(),setTimeout((function(){e.setTableColumn(),e.initPage()}),300)},created:function(){this.getTypeTree(),this.getRepairTypeList(),this.$store.commit("setWorkStationActivePage","设备报修")},destroyed:function(){this.$store.commit("setWorkStationActivePage",null)}},k=O,D=k,y=(a("848c"),a("2877")),R=Object(y["a"])(D,i,r,!1,null,"51b92321",null);t["default"]=R.exports},f06d:function(e,t,a){}}]);
//# sourceMappingURL=chunk-223136f6.fdc1d7dd.js.map