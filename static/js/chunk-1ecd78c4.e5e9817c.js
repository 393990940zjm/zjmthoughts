(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ecd78c4"],{"37fd":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"kanban"},[a("Header",{attrs:{titleName:"设备产能能效统计"}}),a("search-bar",{attrs:{searchData:e.searchData,searchOptions:e.searchOptions},on:{search:e.search,getGroupSucceed:e.loadData}}),a("div",{staticClass:"kanbanContent"},[a("div",{staticClass:"top_content"},[a("card-module",{attrs:{title:"稼动率",isExport:!1,cardBg:"cardBg_large",titleBg:"cardTitle_large",width:"100%",height:"100%",titleWidth:"70%"},on:{exportExcel:function(t){return e.exportEchart()}}},[a("div",{ref:"yieldChart",staticStyle:{width:"100%",height:"100%"}})])],1),a("div",{staticClass:"bottom_content"},[a("card-module",{attrs:{title:"产能统计",isExport:!1,cardBg:"cardBg_large",titleBg:"cardTitle_large",width:"100%",height:"100%",titleWidth:"70%"},on:{exportExcel:e.exportTable}},[a("div",{staticClass:"warn_list"},[a("div",{ref:"warnContent",staticClass:"warn_content"},[a("table",{key:e.timers,staticClass:"tableHead",attrs:{cellpadding:"0",cellspacing:"0",width:"100%"}},[a("thead",[a("tr",e._l(e.tableColumns,(function(t,n){return a("td",{key:n,style:{width:t.width+"px"}},[e._v(e._s(t.title))])})),0)]),a("tbody",[a("tr",e._l(e.actualTableData,(function(t,n){return a("td",{key:n,staticClass:"active",style:{width:t.width+"px"}},[e._v(e._s(t.title))])})),0),a("tr",e._l(e.OKTableData,(function(t,n){return a("td",{key:n,staticClass:"active",style:{width:t.width+"px"}},[e._v(e._s(t.title))])})),0)])])])])])],1)])],1)},i=[],r=(a("99af"),a("4160"),a("d81d"),a("b0c0"),a("a9e3"),a("b680"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("159b"),a("96cf"),a("1da1")),o=a("2909"),c=a("cf45"),l=a("99f6"),s=a("78fe"),u=a("e9c43"),d=a("5995"),h=a("176a"),f=a("582a"),b=a("f82c"),p=a("ef53"),m=a("7598"),g={name:"kanban_xw_DTplato",components:{CardModule:s["a"],searchBar:u["a"],Header:d["a"]},data:function(){return{timers:"",yieldDeviceName:"裁切检测包装机25305-1",title:"",groupId:0,time:"",dataTime:"",tableHeight:180,searchData:{groupValue:[1,6,7,"00000165_00000001"],date:[Object(p["b"])(15)+" 00:00:00",Object(p["b"])(0)+" 23:59:59"],timeKeyEnum:"DAY"},pageConfig:{total:0,currentPage:1,pageSize:20,align:"right",pageSizes:[10,20,50,100,200,500],layouts:["Sizes","PrevPage","Number","NextPage","Total"],perfect:!0},searchOptions:[{type:"cascader",key:"groupValue",options:[]},{type:"daterange",key:"date",options:[{label:"日",value:"DAY"},{label:"周",value:"WEEK"},{label:"月",value:"MONTH"}]}],tableData:[],tableColumns:[],actualTableData:[],OKTableData:[],NGTableData:[],yieldTableData:[],kanbanConfig:{title:"",key:"",time:15e3},yieldXData:[],yieldData:[],planYield:[],coatingData:{},barChartInfo:{current:1,size:4},maintainAnalyse:{current:1,size:4},timer:null,yiledKey:"产量"}},mounted:function(){var e=this;document.documentElement.style.fontSize=this.fontSize()+"px",window.onresize=function(){document.documentElement.style.fontSize=e.fontSize()+"px"},this.loadData(),this.timer=setInterval((function(){e.loadData()}),36e5)},created:function(){var e=this;l["m"][this.getUrlKeyMain("cid",window.location.href)]&&(e.kanbanConfig=l["m"][this.getUrlKeyMain("cid",window.location.href)]),this.getGroupLineDevice()},destroyed:function(){this.timer&&clearInterval(this.timer)},methods:{exportEchart:function(){var e=[];Object(h["a"])({multiHeader:e,header:[""].concat(Object(o["a"])(this.yieldXData)),data:[["良品率"].concat(Object(o["a"])(this.yieldData)),["计划良率"].concat(Object(o["a"])(this.planYield))],filename:this.yieldDeviceName+"-良率推移图报表",merges:[]})},exportTable:function(){var e=[],t=Object(o["a"])(this.tableColumns.map((function(e){return e.title}))),a=[Object(o["a"])(this.actualTableData.map((function(e){return e.title}))),Object(o["a"])(this.OKTableData.map((function(e){return e.title}))),Object(o["a"])(this.NGTableData.map((function(e){return e.title}))),Object(o["a"])(this.yieldTableData.map((function(e){return e.title+"%"})))];Object(h["a"])({multiHeader:e,header:t,data:a,filename:this.yieldDeviceName+"-良率报表",merges:[]})},getGroupLineDevice:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a={isProductionDevice:1},t.next=4,Object(m["n"])(a,{secretKey:e.kanbanConfig.key});case 4:for(n=t.sent,i=0;i<n.rows.length;i++)n.rows[i].code&&(n.rows[i].id=n.rows[i].code);n.rows=Object(b["a"])(n.rows),e.searchOptions[0].options=n.rows,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},fontSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(t){var a=t/1920;return e*a}},showLogo:function(){return"logo_"+this.kanbanConfig.logo},getUrlKeyMain:function(e,t){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||["",""])[1].replace(/\+/g,"%20"))||null},getYieldChartData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,i,r,o,c,l,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.searchData,n=a.timeKeyEnum,i=a.date,r=a.groupValue,o={queryDateTypeEnum:n,startTime:i[0],endTime:i[1]},r&&(c=r[r.length-1],o.deviceCode=c),t.next=6,Object(m["v"])(o,{secretKey:e.kanbanConfig.key});case 6:l=t.sent,l.code===f["M"].OPERATION_SUCCESS?(s=[],u=[],l.rows.forEach((function(e){s.push(e.time.substr(5,5)),u.push(e.value)})),e.drawYieldChart(s,u)):e.drawYieldChart([],[]),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},getProductivityChartData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,i,r,o,c,l,s,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.searchData,n=a.timeKeyEnum,i=a.date,r=a.groupValue,o={queryDateTypeEnum:n,startTime:i[0],endTime:i[1]},r&&(c=r[r.length-1],o.deviceCode=c),t.next=6,Object(m["u"])(o,{secretKey:e.kanbanConfig.key});case 6:l=t.sent,l.code===f["M"].OPERATION_SUCCESS&&(s=[],u=[],d=[],l.rows.forEach((function(e){s.push({title:e.time.substr(5,5),width:80}),u.push({title:e.value,width:80}),d.push({title:e.value2,width:80})})),e.tableColumns=[{title:"日期",width:120}].concat(s),e.actualTableData=[{title:e.yiledKey,width:120}].concat(u),e.OKTableData=[{title:"用电量(KW.h)",width:120}].concat(d)),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},drawYieldChart:function(e,t){var a=this.$echarts.init(this.$refs.yieldChart),n={tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function(e){for(var t=e[0].name,a=0,n=e.length;a<n;a++)t+="<br/>"+e[a].marker+e[a].seriesName+" : "+Number(e[a].value).toFixed(2)+"%";return t}},legend:{show:!0,top:"0%",textStyle:{color:"#ffffff",fontSize:Object(c["b"])(16)}},grid:{top:"10%",left:"3%",right:"5%",bottom:"15%",containLabel:!0},xAxis:[{type:"category",name:"日期",data:e,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:"#929EE6"}},axisLabel:{fontSize:Object(c["b"])(18),color:"#D8D8D8"},nameTextStyle:{fontSize:Object(c["b"])(18)}}],yAxis:[{type:"value",name:"稼动率",axisLine:{lineStyle:{color:"#929EE6"}},axisLabel:{formatter:"{value}%",fontSize:Object(c["b"])(18),color:"#ffffff"},nameTextStyle:{fontSize:Object(c["b"])(18)},splitLine:{show:!0,lineStyle:{type:"dashed",color:"#24ffff",opacity:.5}}}],series:[{name:"稼动率",type:"line",showAllSymbol:!0,symbol:"circle",symbolSize:10,itemStyle:{color:"#058cff"},lineStyle:{color:"#058cff"},areaStyle:{color:"rgba(5,140,255, 0.2)"},label:{normal:{show:!0,formatter:function(e){return e.value+"%"},position:"top",fontSize:Object(c["b"])(18),color:"#ffffff"}},data:t}]};a.setOption(n,!0),window.addEventListener("resize",(function(){a.resize()}))},getYieldConfig:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a={},e.getUrlKeyMain("cid",window.location.href)&&(a.secretKey=e.kanbanConfig.key),t.next=5,Object(m["p"])({configurationTypeEnum:"PRODUCTION_CONFIGURATION"},a);case 5:n=t.sent,"0000"===n.code&&(e.yiledKey=(null===(i=n.rows)||void 0===i?void 0:i.processConfiguration)||"产量"),t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](0);case 11:return t.prev=11,e.getProductivityChartData(),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,9,11,14]])})))()},search:function(){this.loadData()},loadData:function(){this.getYieldChartData(),this.getYieldConfig()}}},y=g,v=(a("3c76"),a("2877")),w=Object(v["a"])(y,n,i,!1,null,"9063db74",null);t["default"]=w.exports},"3c76":function(e,t,a){"use strict";var n=a("e980"),i=a.n(n);i.a},e980:function(e,t,a){}}]);
//# sourceMappingURL=chunk-1ecd78c4.e5e9817c.js.map